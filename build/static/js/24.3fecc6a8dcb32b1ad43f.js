webpackJsonp([24],{Mvzc:function(e,t){},"Q+76":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Gu7T"),i=a.n(n),r={components:{},props:{},data:function(){return{conFirm:!1,filters:[{text:"水表",value:"水表"},{text:"无线单表",value:"无线单表"},{text:"采集器",value:"采集器"}],selected:"",load:!1,errScroll:null,tableData:[]}},watch:{},computed:{},methods:{filterType:function(e,t,a){return t.type===e},initScroll:function(e,t){var n;e?e.refresh():a.e(31).then(a.bind(null,"GQaK")).then(function(a){n=a.default,(e=new n(t,{eventPassthrough:"horizontal"})).on("scroll",function(e){})})},searchdata:function(e){var t=this;return this.$http.get("/weiXin/api/v1/deviceMend/getDeviceExceptions",{deviceTypes:e,pageNum:1,pageSize:30,searchType:1},{"Content-Type":"application/json; charset=UTF-8"},!0).then(function(e){if(e&&e.data.data.length>0){var a=e.data.data.map(function(e){return{type:(2==e.deviceType?"采集器":3==e.deviceType&&"水表")||1==e.deviceType&&"无线单表",date:e.deviceNumber,alarmTime:e.alarmTime,exception:e.exception}});t.tableData=[].concat(i()(a))}})},confirm:function(){var e=this;this.$prompt("请输入维修信息","设备维修",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var a=t.value;e.$http.post("/weiXin/api/v1/deviceMend/mendDevice",{deviceNumbers:e.selected.map(function(e){return e.date}),remark:a},{"Content-Type":"application/json; charset=UTF-8"},!0).then(function(t){console.log(t),0==t.data.code?(e.selected.forEach(function(t,a){return[e.tableData.forEach(function(a,n){a.date==t.date&&e.tableData.splice(n,1)})]}),e.$message({type:"success",message:"维修成功"})):e.$message({type:"error",message:"维修失败"})})}).catch(function(){})},handleSelectionChange:function(e){this.multipleSelection=e,this.conFirm=this.multipleSelection.length>0,this.selected=this.multipleSelection,console.log(this.selected)}},created:function(){},mounted:function(){var e=this;this.load=!0,this.$https.all([this.searchdata(1),this.searchdata(2),this.searchdata(3)]).then(this.$https.spread(function(t,a,n){e.load=!1})),this.$nextTick(function(){e.initScroll(e.errScroll,e.$refs.errWrapper)})},activated:function(){var e=this;this.$https.all([this.searchdata(1),this.searchdata(2),this.searchdata(3)]).then(this.$https.spread(function(t,a,n){e.load=!1})),this.$nextTick(function(){e.initScroll(e.errScroll,e.$refs.errWrapper)})}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"equipErr"}},[a("div",{staticClass:"block"},[a("header",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.conFirm,expression:"conFirm"}],staticStyle:{color:"#67c23a"},attrs:{type:"text"},on:{click:e.confirm}},[e._v("维修确认")])],1),e._v(" "),a("div",{ref:"errWrapper",staticClass:"cloWra"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],staticClass:"searchResult",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",stripe:"","header-row-class-name":"equipHead","row-class-name":"equipTabel",data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",fixed:"left",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{filters:e.filters,"filter-method":e.filterType,prop:"type",label:"设备类型",width:"85"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"设备编号",width:"95"}}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmTime",label:"报警时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"exception",label:"异常原因"}})],1)],1)])])},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(e){a("Mvzc")},null,null);t.default=c.exports}});
//# sourceMappingURL=24.3fecc6a8dcb32b1ad43f.js.map