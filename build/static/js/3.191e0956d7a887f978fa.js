webpackJsonp([3],{"/4pB":function(t,e){},"2bEU":function(t,e,a){"use strict";var i={components:{},props:{title:{type:String,default:"title"}},data:function(){return{}},watch:{},computed:{},methods:{cancle:function(){this.$el.style.display="none"}},created:function(){},mounted:function(){}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"DetailEdit"}},[a("header",[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:t.cancle}},[t._v("返回")])],1),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v(t._s(this.title))]),t._v(" "),a("el-col",{attrs:{span:4}},[t._t("operation")],2)],1)],1),t._v(" "),a("section",[t._t("content")],2)])},staticRenderFns:[]};var l=a("VU/8")(i,n,!1,function(t){a("/4pB")},null,null);e.a=l.exports},BON1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),n=a.n(i),l=a("//Fk"),s=a.n(l),r=a("ifoU"),c=a.n(r),o=a("BO1k"),u=a.n(o),d=a("Gu7T"),p=a.n(d),v=a("BlC7"),h=a("2bEU"),f=a("bQhI"),m=(a("IcnI"),{components:{},props:{},data:function(){return{timechoice:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},watch:{},computed:{},methods:{searchHistory:function(){this.$store.commit("changehistorytimeChoice",this.timechoice)}},created:function(){},mounted:function(){}}),_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"selectTime"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-date-picker",{ref:"select",attrs:{editable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","popper-class":"timeSelect2",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","picker-options":t.pickerOptions},model:{value:t.timechoice,callback:function(e){t.timechoice=e},expression:"timechoice"}})],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticClass:"search",on:{click:t.searchHistory}},[t._v("查询")])],1)],1)],1)},staticRenderFns:[]};var y=a("VU/8")(m,_,!1,function(t){a("QN27")},null,null).exports,w=a("nNFT"),g=a("GQaK"),b=a("hhiW");a("pFYg");var F={components:{QR:v.a,more:f.a,DetailEdit:h.a,seleceTime:y,historyData:w.a,edit:b.a},props:{},filters:{},data:function(){return{sseConnect:!1,deleteResult:!1,deleteArray:[],collectorData:"",isDown:!1,isUp:!1,pageNum:1,watermeterWrapper:null,dataFilt:[],status:null,unstatus:null,valve:null,unvalve:null,join:null,unjoin:null,tableData:[],tableDataNav:[],watermeterRow:"",watermeterData:{houseNumber:null},SelectionArray:[],deviceNum:null,watermeterdeviceNum:null,meterSwitch:!1,radioSwitch:"0",oneData:"",batchProcessing:!1,switchLoad:!1}},watch:{qrId:function(t,e){this.oneData=t},filterData:function(t,e){var a=this;this.pageNum;if(this.dataFilt.length>0){!function e(){var i;a.pageNum++,(i=a.tableData).push.apply(i,p()(a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum))),t.length!==a.currentData.length&&e()}()}},dataFilt:function(t){console.log(t)}},computed:{refreshTxt:function(){return this.isEnd?"--无更多数据--":"--上拉加载更多--"},qrId:function(){return this.$store.state.qrId},filterData:function(){return this.filtTableData(this.tableDataNav,this.dataFilt)},currentData:function(){return this.filtTableData(this.tableData,this.dataFilt)}},methods:{selectAll:function(){this.SelectionArray=this.filterData.map(function(t){return t.deviceNumber})},hideMenu:function(){this.$refs.waterMenu.classList.toggle("isShow")},getCollectorData:function(){var t=this;this.$http.post("/weiXin/api/v1/deviceManager/getListDeviceBySearch",{deviceNum:this.deviceNum,pageNum:1,pageSize:null,type:2},{"Content-Type":"application/json;"},!0).then(function(e){e&&(console.log(e),t.collectorData=e.data.data.list[0])}).catch(function(t){})},watermeterSelectionChange:function(t){var e=[],a=!0,i=!1,n=void 0;try{for(var l,s=u()(t);!(a=(l=s.next()).done);a=!0){var r=l.value;e.push(r.deviceNumber)}}catch(t){i=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw n}}this.SelectionArray=e},getListDataFromNet:function(t,e){var a=this;setTimeout(function(){a.oneData?a.searchData(t,a.oneData).then(function(t){e(t)}):a.searchData(t).then(function(t){e(t)})},1e3)},initScroll:function(t,e){var a=this;t?t.refresh():(t=new g.default(e,{scrollX:!0,click:!0,directionLockThreshold:5,pullUpLoad:{threshold:-50},pullDownRefresh:{threshold:55,txt:"刷新"}}),this.watermeterWrapper=t,t.on("scroll",function(t){a.isDown?a.isDown?a.$refs.freshing.style.transform="translate(0,20px)":a.isUp:(t.y>20?a.$refs.isDown.style.visibility="visible":a.$refs.isDown.style.visibility="hidden",a.$refs.isDown.style.transform="translate(0,"+(t.y-40)+"px)")}),t.on("pullingUp",function(){var e;(a.isUp=!0,a.pageNum++,a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum).length>0)&&(a.tableDataNav.length==a.SelectionArray.length&&a.$refs.multipleTable.toggleAllSelection(!0),(e=a.tableData).push.apply(e,p()(a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum))),a.$nextTick(function(){t.refresh(),t.finishPullUp()}))}),t.on("pullingDown",function(){a.isDown=!0,a.pageNum=1,a.oneData=null,a.getListDataFromNet(a.pageNum,function(e){var i;a.tableDataNav=e,a.tableData=[],(i=a.tableData).push.apply(i,p()(a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum))),a.isDown=!1,a.$nextTick(function(){t.refresh(),t.finishPullDown()}),e.length})}))},filtTableData:function(t,e){var a=[],i=new c.a([["valve",function(t){return 0==t.valve}],["unvalve",function(t){return 1==t.valve}],["half",function(t){return 2==t.valve}],["join",function(t){return 1==t.joinStatus}],["unjoin",function(t){return 0==t.joinStatus}],["status",function(t){return 0!=t.deviceStatus}],["unstatus",function(t){return 0==t.deviceStatus}],["setup",function(t){return 1==t.setupStatus}],["unsetup",function(t){return 1!=t.setupStatus}],["polling",function(t){return 1==t.pollingTest}],["unpolling",function(t){return 1!=t.pollingTest}],["pass1",function(t){return 1==t.chanelnum}],["pass2",function(t){return 2==t.chanelnum}],["pass3",function(t){return 3==t.chanelnum}],["pass4",function(t){return 4==t.chanelnum}]]);return e.length>0?(function(){var n=[],l=function(t){i.forEach(function(e,a){t==a&&n.push(e)})},s=!0,r=!1,c=void 0;try{for(var o,d=u()(e);!(s=(o=d.next()).done);s=!0)l(o.value)}catch(t){r=!0,c=t}finally{try{!s&&d.return&&d.return()}finally{if(r)throw c}}a=t.filter(function(t){var e=0;return n.forEach(function(a){a(t)&&e++}),e==n.length})}(),a):t},searchData:function(t,e){var a=this;return new s.a(function(i){a.$http.post("/weiXin/api/v1/deviceManager/getListDeviceBySearch",{collectorNum:a.deviceNum,pageNum:t,pageSize:null,searchField:e,type:3},{"Content-Type":"application/json;"},!0).then(function(t){if(t){var e=t.data.data.list;e=e.filter(function(t){return 1==t.chanelnum}).sort(function(t,e){return t.deviceNumber-e.deviceNumber}).concat(e.filter(function(t){return 2==t.chanelnum}).sort(function(t,e){return t.deviceNumber-e.deviceNumber}),e.filter(function(t){return 3==t.chanelnum}).sort(function(t,e){return t.deviceNumber-e.deviceNumber}),e.filter(function(t){return 4==t.chanelnum}).sort(function(t,e){return t.deviceNumber-e.deviceNumber}),e.filter(function(t){return null==t.chanelnum})),i(e)}}).catch(function(t){})})},watermeterSwitch:function(t,e,a){this.watermeterdeviceNum=e,this.meterSwitch=!0,this.radioSwitch=a},historySearch:function(t){this.batchProcessing||(this.watermeterdeviceNum!=t.deviceNumber&&(this.$store.commit("changehistorytimeChoice",null),this.$refs.historyData.$data.tableData=[],this.$refs.historyData.$data.timechoice=""),this.watermeterRow=t,this.watermeterdeviceNum=t.deviceNumber,this.watermeterData=n()({},t),this.$refs.edit.$el.style.display="block")},waterClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},saveEdit:function(){var t=this;this.$confirm("是否保存修改","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("/weiXin/api/v1/deviceManager/deviceEdit",{deviceNumber:t.watermeterdeviceNum,houseNumber:t.watermeterData.houseNumber,deviceType:3}).then(function(e){e&&(t.$refs.edit.cancle(),t.watermeterRow.houseNumber=t.watermeterData.houseNumber,t.$message({type:"success",message:"修改成功!"}))})}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},reconnect:function(t,e){var a=this;this.$confirm("是否重新挂接 "+t.length+"个水表"+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){return new s.a(function(e,i){a.$http.post("/weiXin/api/v1/deviceManager/join",{generalNums:t,collectorNum:a.deviceNum},{"Content-Type":"application/json;"},!0).then(function(t){t&&(a.$message({type:"success",message:"命令下发成功"}),e(a))}).catch(function(){i()})})}).catch(function(){})},batchConnect:function(){this.reconnect(this.SelectionArray)},connectRemove:function(t,e){var a=this;this.$confirm("是否移除"+t.length+"个水表 "+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.$http.post("/weiXin/api/v1/deviceManager/bashDeleteGeneral",{generalNums:t,collectorNum:a.deviceNum},{"Content-Type":"application/json;"},!0).then(function(t){t&&0==t.data.code&&(a.$message({type:"success",message:"命令下发成功"}),a.SelectionArray>0||0)})}).catch(function(){})},batchRemove:function(){this.connectRemove(this.SelectionArray)},searchoneData:function(){var t=this;this.oneData&&this.searchData(this.pageNum,this.oneData).then(function(e){t.tableDataNav=t.tableData=[].concat(p()(e)),t.$nextTick(function(){t.initScroll(t.watermeterWrapper,t.$refs.watermeterScroll)})})},removeWatermeter:function(t,e){var a=this;this.$confirm("是否删除水表 ","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.$http.get("/weiXin/api/v1/deviceMend/deleteDevice",{deviceNum:t.deviceNumber,deviceType:3}).then(function(t){t&&(a.$refs.edit.cancle(),a.currentData.splice(e,1),a.$message({type:"success",message:"删除成功!"}))})}).catch(function(){})},switchConfirm:function(t){var e=this;this.switchLoad=!0;this.$http.post("/weiXin/api/v1/deviceManager/bashValveSwitch",{deviceNums:t,collectorNum:this.deviceNum,value:this.radioSwitch,deviceType:3},{"Content-Type":"application/json;"},!0).then(function(t){t?(setTimeout(function(){e.switchLoad=!1},300),e.meterSwitch=!1,e.$message({type:"success",message:"命令下发成功"})):(setTimeout(function(){e.switchLoad=!1},300),e.meterSwitch=!1)})},isbatchProcessing:function(){this.batchProcessing=!0,this.$refs.moreOperation.cancle()},quitBatch:function(){this.batchProcessing=!1,this.$refs.multipleTable.clearSelection()},watermeterFilter:function(){this.$refs.filt.open()},refreshPage:function(){var t=this;this.pageNum=1,this.getListDataFromNet(this.pageNum,function(e){var a;t.tableDataNav=e,t.tableData=[],(a=t.tableData).push.apply(a,p()(t.tableDataNav.slice(10*(t.pageNum-1),10*t.pageNum))),t.$nextTick(function(){t.watermeterWrapper.refresh()})})}},created:function(){},mounted:function(){var t=this;null!==this.$route.query.deviceNum&&(this.deviceNum=this.$route.query.deviceNum),this.getCollectorData(),this.searchData(this.pageNum).then(function(e){var a;t.tableDataNav=e,(a=t.tableData).push.apply(a,p()(t.tableDataNav.slice(10*(t.pageNum-1),10*t.pageNum))),t.$nextTick(function(){t.initScroll(t.watermeterWrapper,t.$refs.watermeterScroll)})})}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sseConnect,expression:"sseConnect"}],attrs:{id:"watermeterDetail","element-loading-text":"命令执行中，请勿退出","element-loading-background":"#cfcece85"}},[a("header",[a("el-row",{staticClass:"header-title",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:4}},[t.batchProcessing?t._e():a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),t.batchProcessing?a("el-button",{attrs:{type:"primary"},on:{click:t.quitBatch}},[t._v("退出批量操作")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",[t._v("水表")])]),t._v(" "),a("el-col",{staticClass:"addColltector",attrs:{span:4}},[a("more",{ref:"moreOperation"},[a("ul",{attrs:{slot:"list"},slot:"list"},[a("li",{on:{click:function(e){t.$router.push({path:"/watermeter",query:{collectorID:t.deviceNum}})}}},[t._v("挂接水表")]),t._v(" "),a("li",{on:{click:t.isbatchProcessing}},[t._v("批量操作")]),t._v(" "),a("li",{on:{click:t.hideMenu}},[t._v("菜单栏")])])])],1)],1),t._v(" "),a("div",{ref:"waterMenu",staticClass:"water-menu"},[a("el-row",{staticClass:"collectorReplace",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:14}},[t._v("采集器编号："+t._s(this.deviceNum))]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",span:4},nativeOn:{click:function(e){t.$router.push({path:"./replace",query:{collectorId:t.deviceNum,type:2}})}}},[t._v("替换"),a("i",{staticClass:"el-icon-arrow-right"})])],1),t._v(" "),a("el-row",{staticClass:"collectorPassageway",attrs:{type:"flex",justify:"space-between"}},[a("div",[a("p",[t._v("通道一")]),t._v(" "),a("p",{style:{color:!1===t.collectorData.c1?"red":""}},[t._v(t._s(!1===t.collectorData.c1?"异常":"正常"))])]),t._v(" "),a("div",[a("p",[t._v("通道二")]),t._v(" "),a("p",{style:{color:!1===t.collectorData.c2?"red":""}},[t._v(t._s(!1===t.collectorData.c2?"异常":"正常"))])]),t._v(" "),a("div",[a("p",[t._v("通道三")]),t._v(" "),a("p",{style:{color:!1===t.collectorData.c3?"red":""}},[t._v(t._s(!1===t.collectorData.c3?"异常":"正常"))])]),t._v(" "),a("div",[a("p",[t._v("通道四")]),t._v(" "),a("p",{style:{color:!1===t.collectorData.c4?"red":""}},[t._v(t._s(!1===t.collectorData.c4?"异常":"正常"))])])]),t._v(" "),a("el-row",{staticClass:"idSearch"},[a("el-col",{staticClass:"searchInput",attrs:{span:18}},[a("el-input",{attrs:{placeholder:"编号/门牌号"},model:{value:t.oneData,callback:function(e){t.oneData=e},expression:"oneData"}}),t._v(" "),a("QR")],1),t._v(" "),a("el-col",{staticClass:"searchConfirm",attrs:{span:4,offset:1}},[a("el-button",{attrs:{type:"primary"},on:{click:t.searchoneData}},[t._v("查询")])],1)],1)],1),t._v(" "),t.batchProcessing?a("el-row",{staticClass:"batchOperate",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:t.batchConnect}},[t._v("批量挂接")])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:t.batchRemove}},[t._v("批量移除")])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:t.watermeterSwitch}},[t._v("批量开关阀")])],1)],1):t._e()],1),t._v(" "),a("el-row",[a("el-col",[a("more",{ref:"filt",attrs:{custom:!0}},[a("el-row",{attrs:{slot:"operate",type:"flex",justify:"end"},slot:"operate"},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"text"},on:{click:t.watermeterFilter}},[t._v("筛选")])],1)],1),t._v(" "),a("div",{attrs:{slot:"menu"},slot:"menu"},[a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("状态")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"status",value:"status"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"status")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"status");i.checked?l<0&&(t.dataFilt=a.concat(["status"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"status"}},[t._v("正常\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unstatus",value:"unstatus"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unstatus")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unstatus");i.checked?l<0&&(t.dataFilt=a.concat(["unstatus"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unstatus"}},[t._v("异常\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("阀门")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:8}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"valve",value:"valve"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"valve")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"valve");i.checked?l<0&&(t.dataFilt=a.concat(["valve"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"valve"}},[t._v("开\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:8}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"half",value:"half"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"half")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"half");i.checked?l<0&&(t.dataFilt=a.concat(["half"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"half"}},[t._v("半悬\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:8}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unvalve",value:"unvalve"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unvalve")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unvalve");i.checked?l<0&&(t.dataFilt=a.concat(["unvalve"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unvalve"}},[t._v("关\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("挂接")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"join",value:"join"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"join")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"join");i.checked?l<0&&(t.dataFilt=a.concat(["join"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"join"}},[t._v("已挂接\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unjoin",value:"unjoin"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unjoin")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unjoin");i.checked?l<0&&(t.dataFilt=a.concat(["unjoin"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unjoin"}},[t._v("未挂接\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("安装状态")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"setup",value:"setup"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"setup")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"setup");i.checked?l<0&&(t.dataFilt=a.concat(["setup"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"setup"}},[t._v("已安装\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unsetup",value:"unsetup"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unsetup")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unsetup");i.checked?l<0&&(t.dataFilt=a.concat(["unsetup"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unsetup"}},[t._v("未安装\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("轮询结果")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"polling",value:"polling"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"polling")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"polling");i.checked?l<0&&(t.dataFilt=a.concat(["polling"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"polling"}},[t._v("通过\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unpolling",value:"unpolling"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unpolling")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unpolling");i.checked?l<0&&(t.dataFilt=a.concat(["unpolling"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unpolling"}},[t._v("未通过\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("通道")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:6}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"check1",value:"pass1"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"pass1")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"pass1");i.checked?l<0&&(t.dataFilt=a.concat(["pass1"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"check1"}},[t._v("1\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:6}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"check2",value:"pass2"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"pass2")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"pass2");i.checked?l<0&&(t.dataFilt=a.concat(["pass2"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"check2"}},[t._v("2\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:6}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"check3",value:"pass3"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"pass3")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"pass3");i.checked?l<0&&(t.dataFilt=a.concat(["pass3"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"check3"}},[t._v("3\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:6}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"check4",value:"pass4"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"pass4")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"pass4");i.checked?l<0&&(t.dataFilt=a.concat(["pass4"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"check4"}},[t._v("4 \n                                    ")])])],1)],1)])],1)],1)],1),t._v(" "),a("div",{staticClass:"block",attrs:{id:"blankSpace"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDown,expression:"!isDown"}],ref:"isDown",staticClass:"isDown"},[t._v("刷新数据")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isDown,expression:"isDown"}],ref:"freshing"},[a("i",{staticClass:"el-icon-loading"}),t._v("刷新中")]),t._v(" "),a("div",{ref:"watermeterScroll",staticClass:"Wrapper"},[a("div",{ref:"wrapperContent"},[a("el-table",{ref:"multipleTable",staticClass:"searchResult ",attrs:{"row-class-name":"watermeterTable",size:"mini",border:"",data:t.currentData},on:{"selection-change":t.watermeterSelectionChange,"row-click":t.waterClick,"select-all":t.selectAll}},[t.batchProcessing?a("el-table-column",{attrs:{type:"selection",width:"50"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:t.filterData.length.toString(),width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.$index;return[t._v("\n                           "+t._s(a+1)+" \n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"水表编号",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",[t._v("\n                                "+t._s(i.deviceNumber)+"\n                                "),a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.$router.push({path:"./replace",query:{collectorId:i.deviceNumber,type:3}})}}},[t._v("替换")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"joinStatus",label:"挂接状态",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",{style:{color:1==i.joinStatus?"":"red"}},[t._v("\n                                "+t._s(1==i.joinStatus?"已挂接":"未挂接")+"\n                                "),1==!i.joinStatus?a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.reconnect([i.deviceNumber],i.joinStatus)}}},[t._v("重新挂接")]):t._e(),t._v(" "),1==i.joinStatus?a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.connectRemove([i.deviceNumber],i.joinStatus)}}},[t._v("移除挂接")]):t._e()])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"valve",label:"阀门状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("   \n                            "+t._s((1==i.valve?"关":0==i.valve&&"开")||2==i.valve&&"半悬"||"暂无")+"\n                            "),a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.watermeterSwitch(e,i.deviceNumber,i.valve)}}},[t._v("开关")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"readingLatest",label:"最新读数",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("   \n                            "+t._s(i.readingLatest)+"\n                            "),a("span",{staticClass:"singleDetail",on:{click:function(e){t.historySearch(i)}}},[t._v("历史数据")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"门牌号",prop:"houseNumber",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{label:"通道号",prop:"chanelnum",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"设备状态",prop:"deviceStatus",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                            "+t._s(0==a.deviceStatus?"异常":"正常")+"\n                        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"安装状态",prop:"setupStatus",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                            "+t._s(1==a.setupStatus?"已安装":"未安装")+"\n                        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"readingLatestdatetime",label:"读数时间",width:"110"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pollingTest",label:"轮询结果",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                            \n                            "+t._s(1==a.pollingTest?"通过":"未通过")+"\n                        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row,n=e.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.removeWatermeter(i,n)}}},[t._v("彻底删除")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){t.$refs.edition.show(i)}}},[t._v("详情")])]}}])})],1)],1)])]),t._v(" "),a("DetailEdit",{ref:"edit",attrs:{title:"历史数据"}},[a("el-button",{attrs:{slot:"operation",type:"primary"},on:{click:t.saveEdit},slot:"operation"},[t._v("保存")]),t._v(" "),a("el-form",{staticClass:"watermeterEdit",attrs:{slot:"content",model:t.watermeterData,"label-width":"80px"},slot:"content"},[a("el-row",{staticStyle:{"font-size":"15px"},attrs:{type:"flex",justify:"space-between"}},[t._v("\n                    设备ID："+t._s(t.watermeterData.deviceNumber)+"\n                ")]),t._v(" "),a("el-row",[a("p",{staticClass:"editTitle"},[t._v("查询历史数据")])]),t._v(" "),a("historyData",{ref:"historyData",attrs:{deviceNum:t.watermeterdeviceNum}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"开关阀",visible:t.meterSwitch,width:"30%"},on:{"update:visible":function(e){t.meterSwitch=e}}},[a("el-radio",{attrs:{label:"0"},model:{value:t.radioSwitch,callback:function(e){t.radioSwitch=e},expression:"radioSwitch"}},[t._v("开")]),t._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:t.radioSwitch,callback:function(e){t.radioSwitch=e},expression:"radioSwitch"}},[t._v("关")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.meterSwitch=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.SelectionArray.length>0?t.switchConfirm(t.SelectionArray):t.switchConfirm([t.watermeterdeviceNum])}}},[t.switchLoad?a("i",{staticClass:"el-icon-loading"}):t._e(),t._v(" 确认")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"移除挂接结果",visible:t.deleteResult,width:"40%",height:"250"},on:{"update:visible":function(e){t.deleteResult=e}}},[a("el-table",{attrs:{size:"mini",border:"",data:t.deleteArray}},[a("el-table-column",{attrs:{prop:"data",label:"水表编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"messaGE",label:"结果"}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.deleteResult=!1}}},[t._v("确 定")])],1)],1),t._v(" "),a("edit",{ref:"edition"})],1)},staticRenderFns:[]};var k=a("VU/8")(F,D,!1,function(t){a("T4Ld")},null,null);e.default=k.exports},HjM5:function(t,e){},QN27:function(t,e){},T4Ld:function(t,e){},nNFT:function(t,e,a){"use strict";var i=a("//Fk"),n=a.n(i),l=a("Gu7T"),s=a.n(l),r=(a("IcnI"),a("GQaK")),c=a("162o"),o={components:{},props:{deviceNum:{type:String}},data:function(){return{isDown:!1,isUp:!1,isEnd:!1,pageNum:1,detailWrapper:null,tableData:[],timechoice:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},elecData:[],criticalValue:""}},watch:{},computed:{refreshTxt:function(){return this.isEnd?"--无更多数据--":"--上拉加载更多--"}},methods:{getListDataFromNet:function(t,e){var a=this;Object(c.setTimeout)(function(){a.oneData?a.searchData(t,a.oneData).then(function(t){e(t)}):a.searchData(t).then(function(t){e(t)})},1e3)},initScroll:function(t,e){var a=this;t?t.refresh():((t=new r.default(e,{eventPassthrough:"horizontal",pullUpLoad:{threshold:-50},pullDownRefresh:{threshold:55,txt:"刷新"}})).on("scroll",function(t){a.isDown?a.isDown?a.$refs.freshing.style.transform="translate(0,20px)":a.isUp:(t.y>20?a.$refs.isDown.style.visibility="visible":a.$refs.isDown.style.visibility="hidden",a.$refs.isDown.style.transform="translate(0,"+(t.y-40)+"px)")}),t.on("pullingUp",function(){console.log(a),a.isUp=!0,a.pageNum++,a.getListDataFromNet(a.pageNum,function(e){var i;0==e.length&&(a.isEnd=!0),(i=a.tableData).push.apply(i,s()(e)),a.isUp=!1,t.finishPullUp(),t.refresh()})}),t.on("pullingDown",function(){a.isDown=!0,a.pageNum=1,a.getListDataFromNet(a.pageNum,function(e){var i;a.tableData=[],(i=a.tableData).push.apply(i,s()(e)),a.isDown=!1,t.finishPullDown(),t.refresh(),e.length})}))},searchData:function(t){var e=this;return new n.a(function(a){e.$http.get("/weiXin/api/v1/historyReading/getHistoryReading",{deviceNum:e.deviceNum,startTime:e.timechoice[0],endTime:e.timechoice[1],pageNum:t,pageSize:6}).then(function(t){t&&a(t.data.data)})})},searchHistory:function(){var t=this;this.searchData(this.pageNum).then(function(e){t.tableData=e,console.log(t.tableData),t.$nextTick(function(){t.initScroll(t.detailWrapper,t.$refs.detailScroll)})}),this.$http.get("/weiXin/api/v1/thresholdValue/get").then(function(e){e&&(t.criticalValue=e.data.data)})},elecGet:function(){var t=this;this.$http.get("/weiXin/api/v1/thresholdValue/get").then(function(e){e&&(t.elecData=e.data.data)})},historyRowClassName:function(t){t.row}},created:function(){},mounted:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"historyData"}},[a("el-row",{staticClass:"selectTime",attrs:{type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-date-picker",{ref:"select",attrs:{editable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","popper-class":"timeSelect2",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","picker-options":t.pickerOptions},model:{value:t.timechoice,callback:function(e){t.timechoice=e},expression:"timechoice"}})],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticClass:"search",on:{click:t.searchHistory}},[t._v("查询")])],1)],1),t._v(" "),a("div",{staticClass:"block"},[t.isDown?a("div",{ref:"freshing"},[a("i",{staticClass:"el-icon-loading"}),t._v("刷新中")]):a("div",{ref:"isDown",staticClass:"isDown"},[t._v("刷新数据")]),t._v(" "),a("div",{ref:"detailScroll",staticClass:"Wrapper"},[a("div",{ref:"wrapperDetail"},[a("el-table",{staticClass:"searchResult",attrs:{size:"mini",border:"",data:t.tableData,"row-class-name":t.historyRowClassName}},[a("el-table-column",{attrs:{fixed:"",prop:"date",label:"读数时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"历史读数",prop:"reading"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                                "+t._s(a.reading+"吨")+"\n                            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"voltage",label:"电压"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{style:{color:t.$parent.$parent.$parent.watermeterRow?i.voltage<t.criticalValue.cRssiThreshold?"green":"#f56c6c":i.voltage<t.criticalValue.wRssiThreshold?"green":"#f56c6c"}},[t._v("\n                                "+t._s(i.voltage)+"\n\n                                ")])]}}])}),t._v(" "),t.$parent.$parent.$parent.watermeterRow?t._e():a("el-table-column",{attrs:{prop:"signalIntensity",label:"信号强度"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{style:{color:i.signalIntensity<t.criticalValue.wRssiThreshold?"green":"#f56c6c"}},[t._v("\n                                "+t._s(i.signalIntensity)+"\n\n                                ")])]}}])})],1),t._v(" "),t.isUp?a("div",{ref:"download"},[a("i",{staticClass:"el-icon-loading"}),t._v("加载中")]):a("div",{ref:"isUp"},[t._v(t._s(t.refreshTxt))])],1)])])],1)},staticRenderFns:[]};var d=a("VU/8")(o,u,!1,function(t){a("HjM5")},null,null);e.a=d.exports}});
//# sourceMappingURL=3.191e0956d7a887f978fa.js.map