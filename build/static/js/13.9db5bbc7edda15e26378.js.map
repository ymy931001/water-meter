{"version":3,"sources":["webpack:///src/components/list/watermeter/watermeter.vue","webpack:///./src/components/list/watermeter/watermeter.vue?f2d7","webpack:///./src/components/list/watermeter/watermeter.vue"],"names":["_this","this","inventedID","collectorID","getmaparea","handler","newdata","_this2","required","message","trigger","validator","rule","value","callback","_this3","istrictId","then","res","district","options","Geolocation","Geocoder","enableSDKLocation","point","lat","lng","result","province","id","that","form","cityId","data","getVillage","$message","streetNumber","getStatus","_this4","part","val","show","_this5","doornumber","village","address","provinceId","name","number","pid","done","extends_default","catch","e","qrId","selectAddress","QR","watermeter_watermeter","render","_vm","_h","$createElement","_c","_self","attrs","ref","staticClass","model","label-width","rules","label","prop","placeholder","clearable","$$v","$set","expression","_v","on","click","$event","stopPropagation","slctAddress","_s","area","type","onSubmit","showMore","areaConfirm","staticRenderFns","Component","__webpack_require__","normalizeComponent","watermeter","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/13.9db5bbc7edda15e26378.js","sourcesContent":["<template>\r\n\t<div id=\"watermeter\">\r\n\t\t<el-form class=\"textform\" ref=\"form\" :model=\"form\" label-width=\"95px\" :rules=\"rules\">\r\n\t\t\t<!-- <div v-if=\"!$route.query.inventedID\">\r\n\t\t\t\t<el-form-item label=\"详细地址\" prop=\"address\">\r\n\t\t\t\t<el-input v-model=\"form.address\" clearable></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"所属小区\" prop=\"village\" >\r\n\t\t\t\t\t<el-autocomplete\r\n\t\t\t\t\tclass=\"selectVillage\"\r\n\t\t\t\t\tv-model=\"form.village\"\r\n\t\t\t\t\t:fetch-suggestions=\"querySearch\"\r\n\t\t\t\t\tplaceholder=\"XX小区\"\r\n\t\t\t\t\tclearable></el-autocomplete>\r\n\t\t\t\t</el-form-item>\r\n\r\n\t\t\t</div> -->\r\n\t\t\t<el-form-item label=\"门牌号\" prop=\"doornumber\">\r\n\t\t\t\t<el-input v-model=\"form.doornumber\" placeholder=\"1-101\" clearable></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"设备编号\" prop=\"id\">\r\n\t\t\t<el-input v-model=\"form.id\" ></el-input>\r\n\t\t\t<QR/>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item label=\"所属采集器\" prop=\"pid\">\r\n\t\t\t\t<el-input :value=\"form.pid\"></el-input>\r\n\t\t\t</el-form-item>\r\n\t\t\t\r\n\t\t\t<el-form-item label=\"安装位置\">\r\n\t\t\t\t<span class=\"seletArea\"  @click.stop=\"slctAddress\"  >{{form.area}}</span>\r\n\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"onSubmit('form')\">提交</el-button>\r\n\t\t\t</el-form-item>\r\n\t\t\t<el-button type=\"text\" @click=\"showMore\" class=\"showMore\">更多信息<i class=\"el-icon-arrow-right\"></i> </el-button>\r\n\t\t\t<div class=\"watermeterMore\" ref=\"watermeterMore\">\r\n\t\t\t\t<el-form-item label=\"用户姓名\" prop=\"name\">\r\n\t\t\t\t<el-input v-model=\"form.name\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"联系电话\" prop=\"number\">\r\n\t\t\t\t<el-input v-model=\"form.number\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</el-form>\r\n\t\t<selectAddress ref=\"slcAdress\"  @areaConfirm=\"areaConfirm\"></selectAddress>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport selectAddress  from '../../selectAddress/selectAddress.vue'\r\nimport QR from '@/components/QR/QR.vue'\r\nimport store from '@/store/index.js'\r\nimport {offline,removeStorage} from '@/assets/js/offline.js'\r\n\texport default{\r\n\t\t mounted(){\r\n\t\t\t \r\n\t\t\t if(this.$route.query.inventedID !=null){\r\n\t\t\t\t this.form.pid = this.$route.query.inventedID\r\n\t\t\t }\r\n\t\t\t if(this.$route.query.collectorID !=null){\r\n\t\t\t\t this.form.pid = this.$route.query.collectorID\r\n\t\t\t }\r\n\t\t\t this.getmaparea()\r\n\r\n\t\t\tvar EventUtil = {\r\n\t\t\t\taddHandler: function(element, type, handler) {\r\n\t\t\t\t\tif (element.addEventListener) {\r\n\t\t\t\t\t\telement.addEventListener(type, handler, false);\r\n\t\t\t\t\t} else if (element.attachEvent) {\r\n\t\t\t\t\t\telement.attachEvent(\"on\" + type, handler);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement[\"on\" + type] = handler;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tEventUtil.addHandler(window, \"online\", ()=> {\r\n\t\t\t\tthis.isOffline=false\r\n\t\t\t});\r\n\t\t\tEventUtil.addHandler(window, \"offline\", ()=> {\r\n\t\t\t\tthis.isOffline = true\r\n\t\t\t\t\r\n\t\t\r\n\t\t\t});\r\n\t\t },\r\n\t\t watch:{\r\n\t\t\t qrId(newdata,olddata){\r\n\t\t\t\t this.form.id=newdata\r\n\t\t\t\t \r\n\t\t\t }\r\n\t\t },\r\n\t\t data() {\r\n\t\t  return {\r\n\t\t\t\tisOffline:false, \r\n\t\t\t  options:[],\r\n\t\t\t\tform: {\r\n\t\t\t\t\tpid:'',\r\n\t\t\t\t\tid:'',\r\n\t\t\t\t\tvillage:'',\r\n\t\t\t\t\taddress:'',\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tnumber:'',\t\r\n\t\t\t\t\tarea:'请选择地区',\r\n\t\t\t\t\tprovinceId:'',\r\n\t\t\t\t\tcityId:'',\r\n\t\t\t\t\tistrictId:'',\r\n\t\t\t\t\tdoornumber:'',\r\n\t\t\t\t\tlat:null,\r\n\t\t\t\t\tlng:null\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tpid: [\r\n\t\t\t\t\t\t{ required: true, message: '请输入所属采集器编号', trigger: 'blur' },\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\tid: [\r\n\t\t\t\t\t\t{ required: true, message: '请输入水表编号', trigger: 'change' },\r\n\t\t\t\t\t\t{validator: (rule, value, callback)=>{\r\n\t\t\t\t\t\t\tif(value){\r\n\t\t\t\t\t\t\t\tif(value.charAt(4) !=8&&value.charAt(4)!='D'){\r\n\t\t\t\t\t\t\t\t\tcallback(new Error('第5位必须为数字8或者字母D'))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(value.length<10){\r\n\t\t\t\t\t\t\t\t\tcallback(new Error('请输入10位有效数字'))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(value.length>10){\r\n\t\t\t\t\t\t\t\tthis.form.id = value.substring(0,10)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n              \r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}}],\r\n\t\t\t\t\tvillage: [\r\n\t\t\t\t\t\t{ required: true, message: '请输入小区', trigger: 'change' }\r\n\t\t\t\t\t],\r\n\t\t\t\t\taddress: [\r\n\t\t\t\t\t\t{ required: true, message: '请填写详细地址', trigger: 'change' }\r\n\t\t\t\t\t],\r\n\t\t\t\t\tdoornumber:[\r\n\t\t\t\t\t\t{ required: true, message: '请填写门牌号', trigger: 'change' }\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t  }\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowMore(){\r\n\t\t\t\tthis.$refs.watermeterMore.classList.toggle('ishow')\r\n\t\t\t},\r\n\t\t\tgetVillage(){\r\n\t\t\t\tthis.$http.get('/weiXin/api/v1/common/getAreaByPid',{\r\n\t\t\t\t\tid:this.form.istrictId\r\n\t\t\t\t})\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\tif(res){\r\n\t\t\t\t\t\tthis.options=res.data.data.map(val=>{\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue:val.district,\r\n\t\t\t\t\t\t\t\tlabel:val.district\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tquerySearch(queryString, cb) {\r\n\t\t\t\tvar options = this.options;\r\n\t\t\t\tvar results = queryString ? options.filter(this.createFilter(queryString)) : options;\r\n\t\t\t\t// 调用 callback 返回建议列表的数据\r\n\t\t\t\tcb(results);\r\n\t\t\t},\r\n\t\t\tcreateFilter(queryString) {\r\n\t\t\t\treturn (option) => {\r\n\t\t\t\treturn (option.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tgetmaparea(){\r\n\t\t\t\tlet that=this\r\n\t\t\t\tvar geoc = new BMap.Geolocation();\r\n\t\t\t\tvar myGeo = new BMap.Geocoder(); \t\t\r\n\t\t\t\tgeoc.enableSDKLocation();\t\r\n\t\t\t\tgeoc.getCurrentPosition(function(r){\r\n\t\t\t\t\tif(this.getStatus() == BMAP_STATUS_SUCCESS){\r\n\t\t\t\t\t\tvar mk = new BMap.Marker(r.point);\r\n\t\t\t\t\t\tvar mapPoint=new BMap.Point(r.point.lng,r.point.lat)\r\n\t\t\t\t\t\t//坐标转换完之后的回调函数\r\n\t\t\t\t\t\tthat.form.lat=r.point.lat\r\n\t\t\t\t\t\tthat.form.lng=r.point.lng\r\n\t\t\t\t\t\tmyGeo.getLocation(new BMap.Point(r.point.lng, r.point.lat), function(result){      \r\n\t\t\t\t\t\t\tif (result){   \r\n\t\t\t\t\t\t\t\tconsole.log(result)\r\n\t\t\t\t\t\t\tthat.area=result.addressComponents.province + \"-\" + result.addressComponents.city + \"-\" + result.addressComponents.district   \r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthat.$http.get('/weiXin/api/v1/common/getIdsByDistrict',{\r\n\t\t\t\t\t\t\t\tprovince:result.addressComponents.province,\r\n\t\t\t\t\t\t\t\tcity: result.addressComponents.city.substring(0, result.addressComponents.city.length-1),\r\n\t\t\t\t\t\t\t\tdistrict:result.addressComponents.district.substring(0, result.addressComponents.district.length-1)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\tif(res.data.code==0){\r\n\t\t\t\t\t\t\t\t\tthat.form.provinceId=res.data.data[0].id,\r\n\t\t\t\t\t\t\t\t\tthat.form.cityId=res.data.data[1].id,\r\n\t\t\t\t\t\t\t\t\tthat.form.istrictId=res.data.data[2].id\r\n\t\t\t\t\t\t\t\t\tthat.getVillage()\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tthat.form.area=\"请选择地区\",\r\n\t\t\t\t\t\t\t\t\tthat.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\tmessage: '定位失败,请手动选择省市区地址'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthat.form.area=result.addressComponents.province + \"-\" + result.addressComponents.city + \"-\" + result.addressComponents.district \r\n\t\t\t\t\t\t\tthat.form.address=result.addressComponents.street + \"-\" + result.addressComponents.streetNumber\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t}      \r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\talert('failed'+this.getStatus());\r\n\t\t\t\t\t}        \r\n\t\t\t\t});\t\t\r\n\r\n\t\t\t},\r\n\t\t\tareaConfirm(part){\r\n\t\t\t\tlet area =part.map((value,index)=>{\r\n\t\t\t\treturn value.part\r\n\t\t\t\t})\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.form.area = area.join('-')\r\n\t\t\t\t})\r\n\t\t\t\tlet areaid = part.map((val,ind)=>{\r\n\t\t\t\t\tif(val.id>0){\r\n\t\t\t\t\t\treturn val\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.form.provinceId = part[0]&&part[0].id\r\n\t\t\t\tthis.form.cityId = part[1]&&part[1].id\r\n\t\t\t\tthis.form.istrictId=part[2]&&part[2].id\r\n\t\t\t\tthis.getVillage()\r\n\t\t\t},\r\n\t\t\tslctAddress(){\r\n\t\t\t\tthis.$refs.slcAdress.show()\r\n\t\t\t},\r\n\t\t\tonSubmit(form) {\r\n\t\t\t\tlet data={\r\n\t\t\t\t\t\ttype : 3,\r\n\t\t\t\t\t\tdeviceNumber:this.form.id,\r\n\t\t\t\t\t\thouseNumber:this.form.doornumber,\r\n\t\t\t\t\t\tlongitude:this.form.lng,\r\n\t\t\t\t\t\tdistrictSite:this.form.village,\r\n\t\t\t\t\t\tdistrictDetail:this.form.address,\r\n\t\t\t\t\t\tlatitude:this.form.lat,\r\n\t\t\t\t\t\tprovinceId:this.form.provinceId,\r\n\t\t\t\t\t\tcityId:this.form.cityId,\r\n\t\t\t\t\t\tdistrictId:this.form.istrictId,\r\n\t\t\t\t\t\tconsumerUname:this.form.name,\r\n\t\t\t\t\t\ttelephone:this.form.number,\r\n\t\t\t\t\t\tCollectorNum:this.form.pid\r\n\t\t\t\t\t}\r\n\t\t\t\tvar that = this\r\n\t\t\t\tthis.$refs[form].validate(valid=>{\r\n\t\t\t\t\tif(valid){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.$confirm('是否进行安装？', '提示', {\r\n\t\t\t\t\t\t\tconfirmButtonText: '安装',\r\n\t\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\t\t\tcenter: true,\r\n\t\t\t\t\t\t\tcloseOnClickModal:true,\r\n\t\t\t\t\t\t\tbeforeClose: (action, instance, done) => {\r\n\t\t\t\t\t\t\t\tif (action === 'confirm') {\r\n\t\t\t\t\t\t\t\t\tif(that.isOffline){\r\n\t\t\t\t\t\t\t\t\t\toffline('watermeter',data)\r\n\t\t\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = true;\r\n\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '执行中...';\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tthis.$http.post('/weiXin/api/v1/deviceManager/generalInstall',{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...data\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(res){//安装成功\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '安装';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: this.form.id+'安装成功'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},300)\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '安装';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype:'error',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage:res.data.message\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},300)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t.catch(e=>{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(e=='timeout'){//安装超时，网络不好\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toffline('watermeter',data)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '安装';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else{\t\r\n\t\t\t\t\t\t\t\t\tdone()\t\t//点击其他区域关闭\r\n\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '安装';\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\t\tthis.form.id=this.form.id.substring(0,6)\r\n\t\t\t\t\t\t\tthis.form.doornumber=this.form.doornumber.substring(0,this.form.doornumber.length-2)\r\n\t\t\t\t\t\t}).catch((action) => {\r\n\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\ttype:action =='confirm'?'success':'error',\r\n\t\t\t\t\t\t\t\tmessage: action == 'confirm'\r\n\t\t\t\t\t\t\t\t\t\t? '提交成功'\r\n\t\t\t\t\t\t\t\t\t\t: '提交失败'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t} else {\r\n            return false;\r\n          }\r\n\t\t\t\t})\r\n\t\t  },\r\n\t\t},\r\n\t\tcomputed:{\r\n\t\t\tqrId:function(){\r\n\t\t\t\treturn this.$store.state.qrId\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomponents:{\r\n\t\t\t\tselectAddress,\r\n\t\t\t\tQR\r\n\t\t},\r\n\t\tactivated(){\r\n\t\t\tif(this.form.id&&this.form.id>6){\r\n\t\t\t\tthis.$store.commit('changeId',this.form.id.substring(0,6))\r\n\t\t\t}\r\n\t\t\tif(this.form.doornumber&&this.form.doornumber.length>2){\r\n\t\t\t\tthis.form.doornumber=this.form.doornumber.substring(0,this.form.doornumber.length-2)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\t}\r\n</script>\r\n<style scoped lang='less'>\r\n#watermeter{\r\n\tmargin-bottom: 70px;\r\n\t.selectVillage{\r\n\twidth: 100%;\r\n    .el-input__suffix{\r\n\t\t\tright:0;\r\n\t\t}\r\n\t}\r\n\t.showMore{\r\n\t\tmargin-top: -15px;\r\n\t}\r\n\t.watermeterMore{\r\n\t\ttransition: transform 0.3s ease-out;\r\n\t\ttransform-origin:0 0;\r\n\t\ttransform: rotateX(-90deg) \r\n\t}\r\n\t.ishow{\r\n\t\ttransform: rotateX(0deg);\r\n\t}\r\n\t\r\n}\r\n\r\n.textform{\r\n\t\tpadding: 0 20px 0 20px;\r\n\t\toverflow-x: scroll;\r\n\t\t-webkit-overflow-scrolling: touch; \r\n}\r\n.seletArea{\r\n\t-webkit-appearance: none;\r\n\tbackground-color: #fff;\r\n\tbackground-image: none;\r\n\tborder-radius: 4px;\r\n\tborder: 1px solid #dcdfe6;\r\n\t-webkit-box-sizing: border-box;\r\n\tbox-sizing: border-box;\r\n\tcolor: #606266;\r\n\tdisplay: inline-block;\r\n\tfont-size: inherit;\r\n\theight: 40px;\r\n\tline-height: 40px;\r\n\toutline: 0;\r\n\tpadding: 0 15px;\r\n\t-webkit-transition: border-color .2s cubic-bezier(.645,.045,.355,1);\r\n\ttransition: border-color .2s cubic-bezier(.645,.045,.355,1);\r\n\twidth: 100%;\r\n}\r\nspan{\r\n\t\twhite-space: nowrap;  /*不换行，超出省略*/\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;  /*超出部分切割显示为省略号 三个缺一不可*/\r\n\t}\r\n\r\n\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/list/watermeter/watermeter.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"watermeter\"}},[_c('el-form',{ref:\"form\",staticClass:\"textform\",attrs:{\"model\":_vm.form,\"label-width\":\"95px\",\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"门牌号\",\"prop\":\"doornumber\"}},[_c('el-input',{attrs:{\"placeholder\":\"1-101\",\"clearable\":\"\"},model:{value:(_vm.form.doornumber),callback:function ($$v) {_vm.$set(_vm.form, \"doornumber\", $$v)},expression:\"form.doornumber\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"设备编号\",\"prop\":\"id\"}},[_c('el-input',{model:{value:(_vm.form.id),callback:function ($$v) {_vm.$set(_vm.form, \"id\", $$v)},expression:\"form.id\"}}),_vm._v(\" \"),_c('QR')],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"所属采集器\",\"prop\":\"pid\"}},[_c('el-input',{attrs:{\"value\":_vm.form.pid}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"安装位置\"}},[_c('span',{staticClass:\"seletArea\",on:{\"click\":function($event){$event.stopPropagation();_vm.slctAddress($event)}}},[_vm._v(_vm._s(_vm.form.area))])]),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.onSubmit('form')}}},[_vm._v(\"提交\")])],1),_vm._v(\" \"),_c('el-button',{staticClass:\"showMore\",attrs:{\"type\":\"text\"},on:{\"click\":_vm.showMore}},[_vm._v(\"更多信息\"),_c('i',{staticClass:\"el-icon-arrow-right\"})]),_vm._v(\" \"),_c('div',{ref:\"watermeterMore\",staticClass:\"watermeterMore\"},[_c('el-form-item',{attrs:{\"label\":\"用户姓名\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"联系电话\",\"prop\":\"number\"}},[_c('el-input',{model:{value:(_vm.form.number),callback:function ($$v) {_vm.$set(_vm.form, \"number\", $$v)},expression:\"form.number\"}})],1)],1)],1),_vm._v(\" \"),_c('selectAddress',{ref:\"slcAdress\",on:{\"areaConfirm\":_vm.areaConfirm}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-2fbda86e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.3.0@vue-loader/lib/selector.js?type=template&index=0!./src/components/list/watermeter/watermeter.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.0@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2fbda86e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=styles&index=0!./watermeter.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=script&index=0!./watermeter.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2fbda86e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=template&index=0!./watermeter.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2fbda86e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/list/watermeter/watermeter.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}