{"version":3,"sources":["webpack:///src/components/list/offline/offlineRecord.vue","webpack:///./src/components/list/offline/offlineRecord.vue?32b5","webpack:///./src/components/list/offline/offlineRecord.vue"],"names":["offlineRecord","Date","end","getRecord","_this","this","deviceId","pageNum","then","res","data","_this2","_this3","refresh","transform","_tableData","arr","finishPullUp","_tableData2","finishPullDown","_this4","recordScroll","offline_offlineRecord","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","font-size","line-height","_v","_s","$route","query","attrs","type","span","ref","editable","format","value-format","popper-class","align","unlink-panels","range-separator","start-placeholder","end-placeholder","picker-options","pickerOptions","model","value","callback","$$v","timechoice","expression","on","click","searchHistory","directives","name","rawName","isDown","size","border","tableData","fixed","prop","label","scopedSlots","_u","key","fn","row","style","color","onlineOffline","isUp","refreshTxt","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/17.e4ed87d7f528df6bb6fa.js","sourcesContent":["<template>\r\n  <div class=\"offlineRecord\">\r\n      <p style=\"font-size:17px;line-height:30px;\">设备ID:{{$route.query.deviceId}} </p>\r\n    <el-row  type=\"flex\" class=\"selectTime\"> \r\n        \r\n        <el-col :span=\"20\">\r\n            <el-date-picker\r\n                v-model=\"timechoice\"\r\n                :editable=\"false\"\r\n                format=\"yyyy-MM-dd\"\r\n                value-format=\"yyyy-MM-dd\"\r\n                type=\"daterange\"\r\n                popper-class=\"timeSelect2\"\r\n                align=\"right\"\r\n                unlink-panels\r\n                ref=\"select\"\r\n                range-separator=\"至\"\r\n                start-placeholder=\"开始时间\"\r\n                end-placeholder=\"结束时间\"\r\n                :picker-options=\"pickerOptions\">\r\n            </el-date-picker>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n            <el-button class=\"search\" @click=\"searchHistory\">查询</el-button>\r\n        </el-col> \r\n    </el-row>\r\n    <div class=\"block\">\r\n        <div class=\"isDown\" ref=\"isDown\" v-show=\"!isDown\">刷新数据</div>\r\n\t\t<div v-show=\"isDown\" ref=\"freshing\"><i class=\"el-icon-loading\"></i>刷新中</div>\r\n        <div class=\"Wrapper\" ref=\"recordScroll\">\r\n            <div>\r\n                <el-table\r\n                    class=\"searchResult\"\r\n                    size=\"mini\"\r\n                    border\r\n                    :data=\"tableData\"\r\n                    >\r\n                    <el-table-column\r\n                        fixed\r\n                        prop=\"date\"\r\n                        label=\"读数时间\"\r\n                        \r\n                        >\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                        label=\"状态\"\r\n                        prop=\"reading\"   \r\n                        >\r\n                        <template slot-scope={row}>\r\n                            <span :style=\"{color:row.onlineOffline==1?'green':'#f56c6c'}\">\r\n                            {{row.onlineOffline==1?'上线':'下线'}}\r\n\r\n                            </span>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n                <div  ref=\"isUp\" v-if=\"!isUp\">{{refreshTxt}}</div>\r\n                <div v-else ref=\"download\"><i class=\"el-icon-loading\"></i>加载中</div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nconst PAGESIZE=15\r\nimport BScroll from 'better-scroll'\r\nexport default {\r\n  components:{},\r\n  props:{},\r\n  data(){\r\n    return {\r\n        tableData:[],\r\n        timechoice: '',\r\n        recordWrapper:null,\r\n        pageNum:1,\r\n        isDown:false,\r\n\t\tisUp:false,\r\n\t\tisEnd:false,\r\n        pickerOptions: {\r\n            shortcuts: [{\r\n                text: '最近一周',\r\n                onClick(picker) {\r\n                    const end = new Date();\r\n                    const start = new Date();\r\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n                    picker.$emit('pick', [start, end]);\r\n                }\r\n            }, {\r\n                text: '最近一个月',\r\n                onClick(picker) {\r\n                    const end = new Date();\r\n                    const start = new Date();\r\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n                    picker.$emit('pick', [start, end]);\r\n                }\r\n            }, {\r\n                text: '最近三个月',\r\n                onClick(picker) {\r\n                    const end = new Date();\r\n                    const start = new Date();\r\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n                    picker.$emit('pick', [start, end]);\r\n                }\r\n            }]\r\n        },\r\n    }\r\n  },\r\n  watch:{},\r\n  computed:{\r\n      refreshTxt:function(){\r\n        return this.isEnd?'--无更多数据--':'--上拉加载更多--'\r\n    }\r\n  },\r\n  methods:{\r\n      searchHistory(){\r\n          this.getRecord()\r\n      },\r\n      getRecord(){\r\n          return new Promise(resolve=>{\r\n              this.$http.get('/weiXin/api/v1/historyReading/getHistoryOnline',{\r\n                  deviceNum:this.$route.query.deviceId,\r\n                  startTime:this.timechoice?this.timechoice[0]:null,\r\n                  endTime:this.timechoice?this.timechoice[1]:null,\r\n                  pageNum:this.pageNum,\r\n                  pageSize:PAGESIZE,\r\n              })\r\n              .then(res=>{\r\n                  if(res){\r\n                      \r\n                      resolve(res.data.data)\r\n                  }\r\n              })\r\n\r\n          })\r\n      },\r\n      getListDataFromNet (pageNum,successCallback) {\r\n\t  // 延时一秒,模拟联网\r\n\t  \r\n      setTimeout(() => {\r\n\t\t\r\n        this.getRecord(pageNum)\r\n        .then(res=>{\r\n            successCallback(res)\r\n        })\r\n\t\t\r\n        \r\n      }, 1000)\r\n    },\r\n      initScroll(Obj,SCobj){\r\n\r\n            if( !Obj ){\r\n                Obj = new BScroll(SCobj,{\r\n                    eventPassthrough:\"horizontal\",\r\n\t\t\t\t\tpullUpLoad:{\r\n\t\t\t\t\tthreshold: -50,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpullDownRefresh:{\r\n\t\t\t\t\tthreshold: 55,\r\n\t\t\t\t\ttxt:'刷新'\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\tObj.on('scroll',(pos)=>{\r\n\t\t\t\t\tif(!this.isDown){\r\n                        if(pos.y>20){\r\n                            this.$refs.isDown.style.visibility='visible'\r\n                        }else{\r\n                            this.$refs.isDown.style.visibility='hidden'\r\n                        }\r\n\t\t\t\t\t\tthis.$refs.isDown.style.transform=`translate(0,${pos.y-40}px)`\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else if(this.isDown){\r\n\t\t\t\t\t\tthis.$refs.freshing.style.transform=`translate(0,20px)`\r\n\t\t\t\t\t}else if(this.isUp){\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t})\r\n\t\t\t\tObj.on('pullingUp',()=>{\r\n\r\n                    this.isUp=true\r\n                    this.pageNum++\r\n                    this.getListDataFromNet(this.pageNum, (arr) => {\r\n                        if(arr.length==0) this.isEnd=true\r\n                        this.tableData.push(...arr)\r\n                        this.isUp=false\r\n                        Obj.refresh()\r\n                        Obj.finishPullUp();\r\n                    })\r\n\r\n\t\t\t\t})\r\n\t\t\t\tObj.on('pullingDown',()=>{\r\n                    this.isDown=true\r\n\t\t\t\t\tthis.pageNum=1\r\n\t\t\t\t\tthis.getListDataFromNet(this.pageNum, (arr) => {\r\n\t\t\t\t\t\tthis.tableData=[]\r\n\t\t\t\t\t\tthis.tableData.push(...arr)\r\n\t\t\t\t\t\tthis.isDown=false\r\n\t\t\t\t\t\tObj.refresh()\r\n                        Obj.finishPullDown();\r\n\t\t\t\t\t\tif(!arr.length>0){\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t})\r\n            }else{\r\n                Obj.refresh() \r\n            }\r\n        },\r\n  },\r\n  created(){},\r\n  mounted(){\r\n      this.getRecord()\r\n      .then(res=>{\r\n          this.tableData=res\r\n          this.initScroll(this.recordWrapper,this.$refs.recordScroll)\r\n      })\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\">\r\n.offlineRecord{\r\n    .selectTime{\r\n        margin: 0 10px;\r\n        margin-bottom: 10px;\r\n        .el-date-editor{\r\n            width: 300px;\r\n        }\r\n        .search{\r\n        width: 100%;\r\n        margin-left: 5px;\r\n        padding: 0;\r\n        height: 100%;\r\n        }\r\n\r\n    }\r\n    .block{\r\n        height: 67vh;\r\n        text-align: center;\r\n        .isDown{\r\n            visibility: hidden;\r\n            transform:translate(0,-40px)\r\n        }\r\n        .Wrapper{\r\n            height: 100%;\r\n            overflow: hidden;\r\n            >div{\r\n                min-height: calc(100% + 1px)\r\n\r\n            }\r\n        }\r\n        .searchResult{\r\n            \r\n        }\r\n    }\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/list/offline/offlineRecord.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"offlineRecord\"},[_c('p',{staticStyle:{\"font-size\":\"17px\",\"line-height\":\"30px\"}},[_vm._v(\"设备ID:\"+_vm._s(_vm.$route.query.deviceId)+\" \")]),_vm._v(\" \"),_c('el-row',{staticClass:\"selectTime\",attrs:{\"type\":\"flex\"}},[_c('el-col',{attrs:{\"span\":20}},[_c('el-date-picker',{ref:\"select\",attrs:{\"editable\":false,\"format\":\"yyyy-MM-dd\",\"value-format\":\"yyyy-MM-dd\",\"type\":\"daterange\",\"popper-class\":\"timeSelect2\",\"align\":\"right\",\"unlink-panels\":\"\",\"range-separator\":\"至\",\"start-placeholder\":\"开始时间\",\"end-placeholder\":\"结束时间\",\"picker-options\":_vm.pickerOptions},model:{value:(_vm.timechoice),callback:function ($$v) {_vm.timechoice=$$v},expression:\"timechoice\"}})],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('el-button',{staticClass:\"search\",on:{\"click\":_vm.searchHistory}},[_vm._v(\"查询\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"block\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isDown),expression:\"!isDown\"}],ref:\"isDown\",staticClass:\"isDown\"},[_vm._v(\"刷新数据\")]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isDown),expression:\"isDown\"}],ref:\"freshing\"},[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\"刷新中\")]),_vm._v(\" \"),_c('div',{ref:\"recordScroll\",staticClass:\"Wrapper\"},[_c('div',[_c('el-table',{staticClass:\"searchResult\",attrs:{\"size\":\"mini\",\"border\":\"\",\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"fixed\":\"\",\"prop\":\"date\",\"label\":\"读数时间\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"状态\",\"prop\":\"reading\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('span',{style:({color:row.onlineOffline==1?'green':'#f56c6c'})},[_vm._v(\"\\n                            \"+_vm._s(row.onlineOffline==1?'上线':'下线')+\"\\n\\n                            \")])]}}])})],1),_vm._v(\" \"),(!_vm.isUp)?_c('div',{ref:\"isUp\"},[_vm._v(_vm._s(_vm.refreshTxt))]):_c('div',{ref:\"download\"},[_c('i',{staticClass:\"el-icon-loading\"}),_vm._v(\"加载中\")])],1)])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-51b4e602\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.3.0@vue-loader/lib/selector.js?type=template&index=0!./src/components/list/offline/offlineRecord.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.0@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-51b4e602\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=styles&index=0!./offlineRecord.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=script&index=0!./offlineRecord.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-51b4e602\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=template&index=0!./offlineRecord.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/list/offline/offlineRecord.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}