webpackJsonp([4],{"0sI4":function(t,e){},"2bEU":function(t,e,a){"use strict";var i={components:{},props:{title:{type:String,default:"title"}},data:function(){return{}},watch:{},computed:{},methods:{cancle:function(){this.$el.style.display="none"}},created:function(){},mounted:function(){}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"DetailEdit"}},[a("header",[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:t.cancle}},[t._v("返回")])],1),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:6}},[t._v(t._s(this.title))]),t._v(" "),a("el-col",{attrs:{span:4}},[t._t("operation")],2)],1)],1),t._v(" "),a("section",[t._t("content")],2)])},staticRenderFns:[]};var l=a("46Yf")(i,n,!1,function(t){a("0sI4")},null,null);e.a=l.exports},"J/UD":function(t,e){},JXuS:function(t,e){},L6HY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("4YfN"),n=a.n(i),l=a("rVsN"),s=a.n(l),r=a("cUn4"),o=a.n(r),c=a("HzJ8"),u=a.n(c),d=a("IHPB"),v=a.n(d),h=a("bQhI"),p=a("BlC7"),f=a("YUvS"),m=a("2bEU"),g=a("nNFT"),w=(a("IcnI"),a("hhiW")),b={components:{more:h.a,QR:p.a,DetailEdit:m.a,historyData:g.a,edit:w.a},props:{},filters:{},data:function(){return{isDown:!1,isUp:!1,isEnd:!1,pageNum:1,singlemeterWrapper:null,tableData:[],tableDataNav:[],dataFilt:[],batchProcessing:!1,oneData:null,singlemeterdeviceNum:null,meterSwitch:!1,radioSwitch:0,switchLoad:!1,SelectionArray:[],singlemeterData:{houseNumber:null}}},watch:{qrId:function(t,e){this.oneData=t},filterData:function(t,e){var a=this;this.pageNum;if(this.dataFilt.length>0){!function e(){var i;a.pageNum++,(i=a.tableData).push.apply(i,v()(a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum))),t.length!==a.currentData.length&&e()}()}},SelectionArray:function(t){console.log(t)}},computed:{refreshTxt:function(){return this.isEnd?"--无更多数据--":"--上拉加载更多--"},qrId:function(){return this.$store.state.qrId},filterData:function(){return this.filtTableData(this.tableDataNav,this.dataFilt)},currentData:function(){return this.filtTableData(this.tableData,this.dataFilt)}},methods:{selectAll:function(){this.SelectionArray=this.tableDataNav.map(function(t){return t.deviceNumber})},hideMenu:function(){this.$refs.waterMenu.classList.toggle("isShow")},singleRowClassName:function(t){return"在线"==t.onlineStatus?"onlineSingle":"离线"==t.onlineStatus?"offlineSingle":void 0},singleFilter:function(){this.$refs.filt.open()},singlemeterSelectionChange:function(t){var e=[],a=!0,i=!1,n=void 0;try{for(var l,s=u()(t);!(a=(l=s.next()).done);a=!0){var r=l.value;e.push(r.deviceNumber)}}catch(t){i=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw n}}this.SelectionArray=e},filtTableData:function(t,e){var a=t,i=new o.a([["valve",function(t){return"开"==t.valve}],["unvalve",function(t){return"关"==t.valve}],["online",function(t){return"在线"==t.onlineStatus}],["offline",function(t){return"离线"==t.onlineStatus}]]);return e.length>0?(function(){var n=[],l=function(t){i.forEach(function(e,a){t==a&&n.push(e)})},s=!0,r=!1,o=void 0;try{for(var c,d=u()(e);!(s=(c=d.next()).done);s=!0)l(c.value)}catch(t){r=!0,o=t}finally{try{!s&&d.return&&d.return()}finally{if(r)throw o}}a=t.filter(function(t){var e=0;return n.forEach(function(a){a(t)&&e++}),e==n.length})}(),a):t},getListDataFromNet:function(t,e){var a=this;setTimeout(function(){a.oneData?a.searchData(t,a.oneData).then(function(t){e(t)}):a.searchData(t).then(function(t){e(t)})},1e3)},initScroll:function(t,e){var a=this;t?t.refresh():((t=new f.default(e,{scrollX:!0,click:!0,directionLockThreshold:5,pullDownRefresh:{threshold:55,txt:"刷新"}})).on("scroll",function(t){a.isDown?a.isDown?a.$refs.freshing.style.transform="translate(0,20px)":a.isUp:(t.y>20?a.$refs.isDown.style.visibility="visible":a.$refs.isDown.style.visibility="hidden",a.$refs.isDown.style.transform="translate(0,"+(t.y-40)+"px)")}),t.on("pullingUp",function(){var e;(a.isUp=!0,a.pageNum++,a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum).length>0)&&(a.tableDataNav.length==a.SelectionArray.length&&a.$refs.multipleTable.toggleAllSelection(!0),(e=a.tableData).push.apply(e,v()(a.tableDataNav.slice(10*(a.pageNum-1),10*a.pageNum))),a.$nextTick(function(){t.refresh(),t.finishPullUp()}))}),t.on("pullingDown",function(){a.isDown=!0,a.pageNum=1,a.oneData=null,a.getListDataFromNet(a.pageNum,function(e){var i;a.tableData=[],(i=a.tableData).push.apply(i,v()(e)),a.isDown=!1,a.$nextTick(function(){t.refresh(),t.finishPullDown()}),e.length})}))},searchData:function(t,e){var a=this;return new s.a(function(i){a.$http.post("/weiXin/api/v1/deviceManager/getListDeviceBySearch",{collectorSearchField:a.deviceNum,pageNum:t,pageSize:null,searchField:e,type:1},{"Content-Type":"application/json;"},!0).then(function(t){if(t){var e=t.data.data.list.map(function(t){return{deviceNumber:t.deviceNumber,test:(0==t.networkingTest?"未测试":1==t.networkingTest&&"已测试")||2==t.networkingTest&&"离线"||3==t.networkingTest&&"测试中",onlineStatus:1==t.onlineStatus?"在线":"离线",readingLatest:t.readingLatest,reportedDatetime:t.reportedDatetime,districtDetail:t.districtDetail,valve:0==t.valve?"开":"关",districtSite:t.districtSite,houseNumber:t.houseNumber,deviceType:1}});e.sort(function(t,e){return t.deviceNumber-e.deviceNumber}),i(e)}}).catch(function(t){})})},quitBatch:function(){this.batchProcessing=!1,this.$refs.multipleTable.clearSelection()},isbatchProcessing:function(){this.batchProcessing=!0,this.$refs.moreOperation.cancle()},watermeterSwitch:function(t,e,a){this.singlemeterdeviceNum=e,this.meterSwitch=!0,this.radioSwitch="开"==a?"1":"关"==a&&"0"},switchConfirm:function(t){var e=this;this.switchLoad=!0;this.$http.post("/weiXin/api/v1/deviceManager/bashValveSwitch",{deviceNums:t,value:this.radioSwitch,deviceType:1},{"Content-Type":"application/json;"},!0).then(function(t){t?(setTimeout(function(){e.switchLoad=!1},300),e.meterSwitch=!1,e.$message({type:"success",message:"命令下发成功"})):(setTimeout(function(){e.switchLoad=!1},300),e.meterSwitch=!1)})},remove:function(t,e,a){var i=this;console.log(t,e,a),this.$confirm("是否移除该无线单表","提示",{confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(n,l,s){"confirm"===n?i.$http.get("/weiXin/api/v1/deviceMend/deleteDevice",{deviceNum:t,deviceType:1}).then(function(t){t&&(a.splice(e,1),s())}):s()}})},searchoneData:function(){var t=this;this.oneData&&this.searchData(this.pageNum,this.oneData).then(function(e){t.tableData=[].concat(v()(e)),t.$nextTick(function(){t.initScroll(t.singlemeterWrapper,t.$refs.singlemeterScroll)})})},singlemeterClick:function(t,e,a){this.batchProcessing||(this.singlemeterdeviceNum!=t.deviceNumber&&(this.$store.commit("changehistorytimeChoice",null),this.$refs.historyData.$data.tableData=[],this.$refs.historyData.$data.timechoice=""),this.singlemeterdeviceNum=t.deviceNumber,this.singlemeterRow=t,this.singlemeterData=n()({},t),this.$refs.edit.$el.style.display="block")},saveEdit:function(){var t=this;this.$http.post("/weiXin/api/v1/deviceManager/deviceEdit",{deviceNumber:this.singlemeterdeviceNum,houseNumber:this.singlemeterData.houseNumber,deviceType:1}).then(function(e){e&&t.$refs.edit.cancle()})}},created:function(){},mounted:function(){var t=this;this.$route.query.id?(this.oneData=this.$route.query.id,this.searchoneData()):this.searchData(this.pageNum).then(function(e){var a;t.tableDataNav=e,(a=t.tableData).push.apply(a,v()(t.tableDataNav.slice(10*(t.pageNum-1),10*t.pageNum))),t.$nextTick(function(){t.initScroll(t.singlemeterWrapper,t.$refs.singlemeterScroll)})})}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"singlemeter"}},[a("header",[a("el-row",{staticClass:"header-title",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:4}},[t.batchProcessing?t._e():a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:function(e){t.$router.push("./nav")}}},[t._v("返回")]),t._v(" "),t.batchProcessing?a("el-button",{attrs:{type:"primary"},on:{click:t.quitBatch}},[t._v("退出批量操作")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",[t._v(t._s(this.title))])]),t._v(" "),a("el-col",{staticClass:"addColltector",attrs:{span:4}},[a("more",{ref:"moreOperation"},[a("ul",{attrs:{slot:"list"},slot:"list"},[a("li",{on:{click:function(e){t.$router.push({path:"/collector",query:{type:1}})}}},[t._v("添加无线单表")]),t._v(" "),a("li",{on:{click:t.isbatchProcessing}},[t._v("批量操作")]),t._v(" "),a("li",{on:{click:t.hideMenu}},[t._v("菜单栏")])])])],1)],1),t._v(" "),a("div",{ref:"waterMenu",staticClass:"water-menu"},[a("el-row",{staticClass:"idSearch"},[a("el-col",{staticClass:"searchInput",attrs:{span:18}},[a("el-input",{attrs:{placeholder:"编号/小区/门牌号"},model:{value:t.oneData,callback:function(e){t.oneData=e},expression:"oneData"}}),t._v(" "),a("QR")],1),t._v(" "),a("el-col",{staticClass:"searchConfirm",attrs:{span:4,offset:1}},[a("el-button",{attrs:{type:"primary"},on:{click:t.searchoneData}},[t._v("查询")])],1)],1)],1),t._v(" "),t.batchProcessing?a("el-row",{staticClass:"batchOperate",attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.meterSwitch=!0}}},[t._v("批量开关阀")])],1)],1):t._e()],1),t._v(" "),a("el-row",[a("el-col",[a("more",{ref:"filt",attrs:{custom:!0}},[a("el-row",{attrs:{slot:"operate",type:"flex",justify:"end"},slot:"operate"},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"text"},on:{click:t.singleFilter}},[t._v("筛选")])],1)],1),t._v(" "),a("div",{attrs:{slot:"menu"},slot:"menu"},[a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("阀门")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"valve",value:"valve"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"valve")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"valve");i.checked?l<0&&(t.dataFilt=a.concat(["valve"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"valve"}},[t._v("开\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"unvalve",value:"unvalve"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"unvalve")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"unvalve");i.checked?l<0&&(t.dataFilt=a.concat(["unvalve"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"unvalve"}},[t._v("关\n                                    ")])])],1)],1),t._v(" "),a("div",{staticClass:"filtType"},[a("el-row",[a("el-col",{staticClass:"filtTitle",attrs:{span:12}},[a("p",[t._v("联网状态")])])],1),t._v(" "),a("el-row",[a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"online",value:"online"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"online")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"online");i.checked?l<0&&(t.dataFilt=a.concat(["online"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"online"}},[t._v("在线\n                                    ")])]),t._v(" "),a("el-col",{staticClass:"filtItme",attrs:{span:12}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataFilt,expression:"dataFilt"}],attrs:{type:"checkbox",id:"offline",value:"offline"},domProps:{checked:Array.isArray(t.dataFilt)?t._i(t.dataFilt,"offline")>-1:t.dataFilt},on:{change:function(e){var a=t.dataFilt,i=e.target,n=!!i.checked;if(Array.isArray(a)){var l=t._i(a,"offline");i.checked?l<0&&(t.dataFilt=a.concat(["offline"])):l>-1&&(t.dataFilt=a.slice(0,l).concat(a.slice(l+1)))}else t.dataFilt=n}}}),t._v(" "),a("label",{attrs:{for:"offline"}},[t._v("离线\n                                    ")])])],1)],1)])],1)],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDown,expression:"!isDown"}],ref:"isDown",staticClass:"isDown"},[t._v("刷新数据")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isDown,expression:"isDown"}],ref:"freshing"},[a("i",{staticClass:"el-icon-loading"}),t._v("刷新中")]),t._v(" "),a("div",{ref:"singlemeterScroll",staticClass:"Wrapper"},[a("div",{ref:"wrapperContent"},[a("el-table",{ref:"multipleTable",staticClass:"searchResult",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",data:t.filtTableData(t.tableData,t.dataFilt)},on:{"select-all":t.selectAll,"selection-change":t.singlemeterSelectionChange,"row-click":t.singlemeterClick}},[t.batchProcessing?a("el-table-column",{attrs:{type:"selection"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:t.filterData.length.toString(),width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.$index;return[t._v("\n                            "+t._s(a+1)+" \n                        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceNumber",label:"无线单表编号",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n                                "+t._s(i.deviceNumber)+"\n                                "),a("span",{staticClass:"singleDetail",on:{click:function(e){t.$router.push({path:"./replace",query:{collectorId:i.deviceNumber,type:1}})}}},[t._v("替换")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"阀门状态",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n                                "+t._s(i.valve)+"\n                                "),a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.watermeterSwitch(e,i.deviceNumber,i.valve)}}},[t._v("开关")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"在线情况",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",{class:t.singleRowClassName(i)},[t._v("\n                                    "+t._s(i.onlineStatus)+"\n                                    "),a("span",{staticClass:"singleDetail",on:{click:function(e){e.stopPropagation(),t.$router.push({path:"/offlineRecord",query:{deviceId:i.deviceNumber}})}}},[t._v("离线记录")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"readingLatest",label:"最近读数",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{prop:"reportedDatetime",label:"读数时间",width:"110"}}),t._v(" "),a("el-table-column",{attrs:{prop:"reportingInterval",label:"上报间隔(日)",width:"135"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                                "+t._s(a.reportingInterval&&a.reportingInterval/86400)+"\n                            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"districtSite",label:"小区位置",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"houseNumber",label:"门牌号",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{prop:"districtDetail",label:"详细地址",width:"170"}}),t._v(" "),a("el-table-column",{attrs:{prop:"test",label:"联网测试",width:"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){a.stopPropagation(),t.remove(e.row.deviceNumber,e.$index,t.tableData)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){a.stopPropagation(),t.$refs.edition.show(e.row)}}},[t._v("详细数据")])]}}])})],1),t._v(" "),t.isUp?a("div",{ref:"download"},[a("i",{staticClass:"el-icon-loading"}),t._v("加载中")]):a("div",{ref:"isUp"},[t._v(t._s(t.refreshTxt))])],1)])]),t._v(" "),a("DetailEdit",{ref:"edit",attrs:{title:"编辑"}},[a("el-button",{attrs:{slot:"operation",type:"primary"},on:{click:t.saveEdit},slot:"operation"},[t._v("保存")]),t._v(" "),a("el-form",{staticClass:"watermeterEdit",attrs:{slot:"content",model:t.singlemeterData,"label-width":"80px"},slot:"content"},[a("el-form-item",{attrs:{label:"门牌号"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.singlemeterData.houseNumber,callback:function(e){t.$set(t.singlemeterData,"houseNumber",e)},expression:"singlemeterData.houseNumber"}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("el-row",[a("p",{staticClass:"editTitle"},[t._v("查询历史数据")])]),t._v(" "),a("historyData",{ref:"historyData",attrs:{deviceNum:t.singlemeterdeviceNum}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"开关阀",visible:t.meterSwitch,width:"30%"},on:{"update:visible":function(e){t.meterSwitch=e}}},[a("el-radio",{attrs:{label:1},model:{value:t.radioSwitch,callback:function(e){t.radioSwitch=e},expression:"radioSwitch"}},[t._v("开")]),t._v(" "),a("el-radio",{attrs:{label:0},model:{value:t.radioSwitch,callback:function(e){t.radioSwitch=e},expression:"radioSwitch"}},[t._v("关")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.meterSwitch=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.SelectionArray.length>0?t.switchConfirm(t.SelectionArray):t.switchConfirm([t.singlemeterdeviceNum])}}},[t.switchLoad?a("i",{staticClass:"el-icon-loading"}):t._e(),t._v(" 确认")])],1)],1),t._v(" "),a("edit",{ref:"edition"})],1)},staticRenderFns:[]};var y=a("46Yf")(b,_,!1,function(t){a("JXuS")},null,null);e.default=y.exports},nNFT:function(t,e,a){"use strict";var i=a("rVsN"),n=a.n(i),l=a("IHPB"),s=a.n(l),r=(a("IcnI"),a("YUvS")),o=a("7Adc"),c={components:{},props:{deviceNum:{type:String}},data:function(){return{isDown:!1,isUp:!1,isEnd:!1,pageNum:1,detailWrapper:null,tableData:[],timechoice:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},elecData:[],criticalValue:""}},watch:{},computed:{refreshTxt:function(){return this.isEnd?"--无更多数据--":"--上拉加载更多--"}},methods:{getListDataFromNet:function(t,e){var a=this;Object(o.setTimeout)(function(){a.oneData?a.searchData(t,a.oneData).then(function(t){e(t)}):a.searchData(t).then(function(t){e(t)})},1e3)},initScroll:function(t,e){var a=this;t?t.refresh():((t=new r.default(e,{eventPassthrough:"horizontal",pullUpLoad:{threshold:-50},pullDownRefresh:{threshold:55,txt:"刷新"}})).on("scroll",function(t){a.isDown?a.isDown?a.$refs.freshing.style.transform="translate(0,20px)":a.isUp:(t.y>20?a.$refs.isDown.style.visibility="visible":a.$refs.isDown.style.visibility="hidden",a.$refs.isDown.style.transform="translate(0,"+(t.y-40)+"px)")}),t.on("pullingUp",function(){console.log(a),a.isUp=!0,a.pageNum++,a.getListDataFromNet(a.pageNum,function(e){var i;0==e.length&&(a.isEnd=!0),(i=a.tableData).push.apply(i,s()(e)),a.isUp=!1,t.finishPullUp(),t.refresh()})}),t.on("pullingDown",function(){a.isDown=!0,a.pageNum=1,a.getListDataFromNet(a.pageNum,function(e){var i;a.tableData=[],(i=a.tableData).push.apply(i,s()(e)),a.isDown=!1,t.finishPullDown(),t.refresh(),e.length})}))},searchData:function(t){var e=this;return new n.a(function(a){e.$http.get("/weiXin/api/v1/historyReading/getHistoryReading",{deviceNum:e.deviceNum,startTime:e.timechoice[0],endTime:e.timechoice[1],pageNum:t,pageSize:6}).then(function(t){t&&a(t.data.data)})})},searchHistory:function(){var t=this;this.searchData(this.pageNum).then(function(e){t.tableData=e,console.log(t.tableData),t.$nextTick(function(){t.initScroll(t.detailWrapper,t.$refs.detailScroll)})}),this.$http.get("/weiXin/api/v1/thresholdValue/get").then(function(e){e&&(t.criticalValue=e.data.data)})},elecGet:function(){var t=this;this.$http.get("/weiXin/api/v1/thresholdValue/get").then(function(e){e&&(t.elecData=e.data.data)})},historyRowClassName:function(t){t.row}},created:function(){},mounted:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"historyData"}},[a("el-row",{staticClass:"selectTime",attrs:{type:"flex"}},[a("el-col",{attrs:{span:20}},[a("el-date-picker",{ref:"select",attrs:{editable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","popper-class":"timeSelect2",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","picker-options":t.pickerOptions},model:{value:t.timechoice,callback:function(e){t.timechoice=e},expression:"timechoice"}})],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{staticClass:"search",on:{click:t.searchHistory}},[t._v("查询")])],1)],1),t._v(" "),a("div",{staticClass:"block"},[t.isDown?a("div",{ref:"freshing"},[a("i",{staticClass:"el-icon-loading"}),t._v("刷新中")]):a("div",{ref:"isDown",staticClass:"isDown"},[t._v("刷新数据")]),t._v(" "),a("div",{ref:"detailScroll",staticClass:"Wrapper"},[a("div",{ref:"wrapperDetail"},[a("el-table",{staticClass:"searchResult",attrs:{size:"mini",border:"",data:t.tableData,"row-class-name":t.historyRowClassName}},[a("el-table-column",{attrs:{fixed:"",prop:"date",label:"读数时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"历史读数",prop:"reading"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n                                "+t._s(a.reading+"吨")+"\n                            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"voltage",label:"电压"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{style:{color:t.$parent.$parent.$parent.watermeterRow?i.voltage<t.criticalValue.cRssiThreshold?"green":"#f56c6c":i.voltage<t.criticalValue.wRssiThreshold?"green":"#f56c6c"}},[t._v("\n                                "+t._s(i.voltage)+"\n\n                                ")])]}}])}),t._v(" "),t.$parent.$parent.$parent.watermeterRow?t._e():a("el-table-column",{attrs:{prop:"signalIntensity",label:"信号强度"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{style:{color:i.signalIntensity<t.criticalValue.wRssiThreshold?"green":"#f56c6c"}},[t._v("\n                                "+t._s(i.signalIntensity)+"\n\n                                ")])]}}])})],1),t._v(" "),t.isUp?a("div",{ref:"download"},[a("i",{staticClass:"el-icon-loading"}),t._v("加载中")]):a("div",{ref:"isUp"},[t._v(t._s(t.refreshTxt))])],1)])])],1)},staticRenderFns:[]};var d=a("46Yf")(c,u,!1,function(t){a("J/UD")},null,null);e.a=d.exports}});
//# sourceMappingURL=4.3b5001fe51982b6ccfad.js.map