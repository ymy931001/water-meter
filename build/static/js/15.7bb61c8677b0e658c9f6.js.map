{"version":3,"sources":["webpack:///src/components/list/replace/replace.vue","webpack:///./src/components/list/replace/replace.vue?6e99","webpack:///./src/components/list/replace/replace.vue"],"names":["replace","selectAddress","QR","required","message","trigger","qrId","newdata","focus","_this","this","istrictId","then","res","district","Geolocation","Geocoder","enableSDKLocation","point","lat","lng","province","id","that","form","cityId","data","getVillage","$message","streetNumber","getStatus","_this2","collectorid","districtSite","houseNumber","latitude","longitude","consumerUname","telephone","districtDetail","provinceId","districtId","show","_this3","part","val","_this4","log","village","address","name","number","done","catch","err","getmaparea","collectorId","showdata","replace_replace","render","_vm","_h","$createElement","_c","_self","attrs","ref","staticClass","model","label-width","rules","label","prop","value","callback","$$v","$set","expression","_v","placeholder","on","click","$event","stopPropagation","slctAddress","_s","area","filterable","remote","allow-create","clearable","nativeOn","touchstart","getfocus","_l","item","key","type","onSubmit","showMore","p","areaID","pId","cId","iId","reshowarea","areaConfirm","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/15.7bb61c8677b0e658c9f6.js","sourcesContent":["<template>\r\n  <div id=\"replace\">\r\n\t\t<el-form class=\"textform\" ref=\"form\" :model=\"form\" label-width=\"95px\" :rules=\"rules\" >\r\n\t\t  <el-form-item label=\"新设备编号\"  prop=\"id\">\r\n\t\t\t<el-input v-model=\"form.id\"></el-input>\r\n\t\t\t<QR/>\t\r\n\t\t  </el-form-item>\r\n\t\t\t<el-form-item class=\"location\" label=\"详细地址\" prop=\"address\">\r\n\t\t  \t<el-input v-model=\"form.address\" placeholder=\"街道/单元\" ></el-input>\r\n\t\t\t\r\n\t\t  </el-form-item>\r\n\t\t  <el-form-item label=\"具体位置\" prop=\"houseNumber\">\r\n\t\t  \t<el-input v-model=\"form.houseNumber\" placeholder=\"例：一单元天台\"></el-input>\r\n\t\t  </el-form-item>\t\r\n\r\n\t\t  \r\n\t\t\t<el-form-item label=\"安装地区\">\r\n\t\t  <span class=\"seletArea\"  @click.stop=\"slctAddress\"  prop=\"area\">{{area}}</span>\r\n\t\t  </el-form-item>\r\n\t\t  <el-form-item label=\"所属小区\"  prop=\"village\">\r\n\t\t\t<el-select v-model=\"form.village\" \r\n\t\t\tfilterable\r\n\t\t\tremote\r\n\t\t\tallow-create \r\n\t\t\tclearable \r\n\t\t\tref=\"select\"\r\n\t\t\t@touchstart.native='getfocus()'\r\n\t\t\tplaceholder=\"XX小区\" \r\n\t\t\tclass=\"selectVillage\">\r\n\t\t\t\t<el-option\r\n\t\t\t\t\tv-for=\"item in options\"\r\n\t\t\t\t\t:key=\"item.value\"\r\n\t\t\t\t\t:label=\"item.label\"\r\n\t\t\t\t\t:value=\"item.value\">\r\n\t\t\t\t</el-option>\r\n\t\t\t</el-select>\r\n\t\t  </el-form-item>\r\n\t\t\t<el-form-item>\r\n\t\t\t<el-button type=\"primary\" @click=\"onSubmit('form')\">替换</el-button>\r\n\t\t  </el-form-item>\r\n\t\t\t<el-button type=\"text\" @click=\"showMore\" class=\"showMore\">更多信息<i class=\"el-icon-arrow-right\"></i> </el-button>\r\n\t\t\t<div class=\"collectorMore\" ref=\"collectorMore\">\r\n\t\t\t\t<el-form-item label=\"用户姓名\" p>\r\n\t\t\t\t<el-input v-model=\"form.name\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"联系电话\" >\r\n\t\t\t\t<el-input v-model=\"form.number\"></el-input>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</div>\r\n\t\t  \r\n\t\t</el-form>\r\n\t\t<selectAddress ref=\"slcAdress\" :areaID=\"{pId:form.provinceId,cId:form.cityId,iId:form.istrictId,}\" @reshowarea='reshowarea' @areaConfirm=\"areaConfirm\"></selectAddress>\r\n\t  \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nconst times = 5  //轮询请求次数\r\nimport selectAddress  from '../../selectAddress/selectAddress.vue'\r\nimport QR from '@/components/QR/QR.vue'\r\nimport store from '@/store/index.js'\r\nexport default {\r\n  components:{\r\n\t\tselectAddress,\r\n\t\tQR\r\n\t},\r\n  props:{},\r\n  data(){\r\n    return {\r\n\t\t\tcollectorid:'',//替换时传过来的设备ID\r\n\t\t\toptions:[],//区域\r\n\t\t\tarea:'请选择位置',\r\n\t\t\tform: {\r\n\t\t\t\tid:'',\r\n\t\t\t\thouseNumber:'',\r\n\t\t\t\taddress:'',\r\n\t\t\t\tname: '',\r\n\t\t\t\tvillage:'',\r\n\t\t\t\tnumber:'',\r\n\t\t\t\tprovinceId:'',\r\n\t\t\t\tcityId:'',\r\n\t\t\t\tistrictId:'',\r\n\t\t\t\tlog:'',\r\n\t\t\t\tlat:'',\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\trules: {\r\n\t\t\t\tid: [\r\n\t\t\t\t\t{ required: true, message: '请输入编号', trigger: 'blur' },\r\n\t\t\t\t\t// { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n\t\t\t\t],\r\n\t\t\t\tsize: [\r\n\t\t\t\t\t{ required: true, message: '请输入规格', trigger: 'change' }\r\n\t\t\t\t],\r\n\t\t\t\tarea:[\r\n\t\t\t\t\t{required:true,message: '请选择地区'}\r\n\t\t\t\t],\r\n\t\t\t\tvillage: [\r\n\t\t\t\t\t{ required: true, message: '请输入小区', trigger: 'change' }\r\n\t\t\t\t],\r\n\t\t\t\taddress: [\r\n\t\t\t\t\t{ required: true, message: '请填写详细地址', trigger: 'change' }\r\n\t\t\t\t],\r\n\t\t\t\thouseNumber:[\r\n\t\t\t\t\t{ required: true, message: '请输入门牌号', trigger: 'change' }\r\n\t\t\t\t]\r\n\t\t\t}\r\n    }\r\n  },\r\n  computed:{\r\n\t\tqrId:function(){\r\n\t\t\tconsole.log(this.$store.state.qrId)\r\n\t\t\treturn this.$store.state.qrId\r\n\t\t\t}\r\n\t\t},\r\n\twatch:{\r\n\t\tqrId(newdata,olddata){\r\n\t\t\tthis.form.id=newdata\r\n\t\t}\r\n\t},\r\n  methods:{\r\n\t\tshowMore(){\r\n\t\t\t\tthis.$refs.collectorMore.classList.toggle('ishow')\r\n\t\t\t},\r\n\t  \tgetfocus(){\r\n\t\t\t\t\r\n\t\t\t\tthis.$refs.select.$children[0].$el.childNodes[1].focus()\r\n\t\t\r\n\t\t},\r\n\t\tgetVillage(){\r\n\t\t\tif(this.form.istrictId!==null){\r\n\t\t\t\tthis.$http.get('/weiXin/api/v1/common/getAreaByPid',{\r\n\t\t\t\t\tid:this.form.istrictId\r\n\t\t\t\t})\r\n\t\t\t\t.then(res=>{\r\n\t\t\t\t\tif(res){\r\n\t\t\t\t\t\tthis.options=res.data.data.map(val=>{\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tvalue:val.district,\r\n\t\t\t\t\t\t\t\tlabel:val.district\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetmaparea(){\r\n\t\t\t\tlet that=this\r\n\t\t\t\tvar geoc = new BMap.Geolocation();\r\n\t\t\t\tvar myGeo = new BMap.Geocoder(); \t\t\r\n\t\t\t\tgeoc.enableSDKLocation();\t\r\n\t\t\t\tgeoc.getCurrentPosition(function(r){\r\n\t\t\t\t\tif(this.getStatus() == BMAP_STATUS_SUCCESS){\r\n\t\t\t\t\t\tvar mk = new BMap.Marker(r.point);\r\n\t\t\t\t\t\tvar mapPoint=new BMap.Point(r.point.lng,r.point.lat)\r\n\t\t\t\t\t\tthat.form.lat=r.point.lat\r\n\t\t\t\t\t\tthat.form.log=r.point.lng\r\n\t\t\t\t\t\t//坐标转换完之后的回调函数\r\n\t\t\t\t\t\tmyGeo.getLocation(new BMap.Point(r.point.lng, r.point.lat), function(result){      \r\n\t\t\t\t\t\t\tif (result){   \r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthat.area=result.addressComponents.province + \"-\" + result.addressComponents.city + \"-\" + result.addressComponents.district   \r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthat.$http.get('/weiXin/api/v1/common/getIdsByDistrict',{\r\n\t\t\t\t\t\t\t\tprovince:result.addressComponents.province,\r\n\t\t\t\t\t\t\t\tcity: result.addressComponents.city.substring(0, result.addressComponents.city.length-1),\r\n\t\t\t\t\t\t\t\tdistrict:result.addressComponents.district.substring(0, result.addressComponents.district.length-1)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif(res&&res.data.code==0){\r\n\t\t\t\t\t\t\t\t\tthat.form.provinceId=res.data.data[0].id,\r\n\t\t\t\t\t\t\t\t\tthat.form.cityId=res.data.data[1].id,\r\n\t\t\t\t\t\t\t\t\tthat.form.istrictId=res.data.data[2].id\r\n\t\t\t\t\t\t\t\t\tthat.getVillage()\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tthat.form.area=\"请选择地区\",\r\n\t\t\t\t\t\t\t\t\tthat.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\tmessage: '定位失败,请手动选择省市区地址'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthat.form.area=result.addressComponents.province + \"-\" + result.addressComponents.city + \"-\" + result.addressComponents.district \r\n\t\t\t\t\t\t\tthat.form.address=result.addressComponents.street + \"-\" + result.addressComponents.streetNumber\r\n\t\t\t\t\t\t\t}      \r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\talert('failed'+this.getStatus());\r\n\t\t\t\t\t}        \r\n\t\t\t\t});\t\t\r\n\t\t\t},\r\n\t\t//数据回显\r\n\t\tshowdata(){\r\n\t\t\tthis.$http.get('/weiXin/api/v1/deviceMend/getReplaceDeviceInstallInfo',{deviceNum:this.collectorid})\r\n\t\t\t.then(res=>{\r\n\t\t\t\tlet Obj = res.data.data\r\n\t\t\t\tif(res){\r\n\t\t\t\t\tthis.form={\r\n\t\t\t\t\t\tid:'',\r\n\t\t\t\t\t\tvillage:Obj.districtSite,\r\n\t\t\t\t\t\thouseNumber:Obj.houseNumber,\r\n\t\t\t\t\t\tlat:Obj.latitude,\r\n\t\t\t\t\t\tlog:Obj.longitude,\r\n\t\t\t\t\t\tname:Obj.consumerUname,\r\n\t\t\t\t\t\tnumber:Obj.telephone,\r\n\t\t\t\t\t\taddress:Obj.districtDetail,\r\n\t\t\t\t\t\tprovinceId : Obj.provinceId,\r\n\t\t\t\t\t\tcityId : Obj.cityId,\r\n\t\t\t\t\t\tistrictId:Obj.districtId,\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.then(()=>{ //小区\r\n\t\t\t\tthis.getVillage()\r\n\r\n\t\t\t})\r\n\t\t},\r\n\t\tslctAddress(){\r\n\t\t\t\tthis.$refs.slcAdress.show()\r\n\t\t\t},\r\n\t\treshowarea(part){\r\n\t\t\tif(part){\r\n\t\t\t\tthis.area = part.join('-')\r\n\t\t\t}\r\n\t\t},\r\n\t\tareaConfirm(part){\r\n\t\t\t\tlet area =part.map((value,index)=>{\r\n\t\t\t\treturn value.part\r\n\t\t\t\t})\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.area = area.join('-')\r\n\t\t\t\t})\r\n\t\t\t\tlet areaid = part.map((val,ind)=>{\r\n\t\t\t\t\tif(val.id>0){\r\n\t\t\t\t\t\treturn val\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.form.provinceId = areaid[0]&&areaid[0].id\r\n\t\t\t\tthis.form.cityId = areaid[1]&&areaid[1].id\r\n\t\t\t\tthis.form.istrictId=areaid[2]&&areaid[2].id\r\n\t\t\t\tthis.getVillage()\r\n\t\t\t},\r\n\t\tonSubmit(form) {\r\n\t\t\t\tthis.$refs[form].validate((valid)=>{\r\n\t\t\t\t\tif(valid){\r\n\t\t\t\t\t\tthis.$confirm(this.$route.query.type==3?'是否替换该设备？':'是否进行测试？', '提示', {\r\n\t\t\t\t\t\t\tshowConfirmButton:this.$route.query.type==3?false:true,\r\n\t\t\t\t\t\t\tconfirmButtonText: '联网测试',\r\n\t\t\t\t\t\t\tcancelButtonText: '替换并安装',\r\n\t\t\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\t\t\tcenter: true,\r\n\t\t\t\t\t\t\tdistinguishCancelAndClose:true,\r\n\t\t\t\t\t\t\tcloseOnClickModal:true,\r\n\t\t\t\t\t\t\tbeforeClose: (action, instance, done) => {\r\n\t\t\t\t\t\t\t\tif (action === 'confirm') {              //联网测试\r\n\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = true;\r\n\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '执行中...';\r\n\r\n\t\t\t\t\t\t\t\t\tthis.$http.post('/weiXin/api/v1/deviceMend/replaceDevice',{//设备替换\r\n\t\t\t\t\t\t\t\t\t\tdeviceNumber:this.form.id,\r\n\t\t\t\t\t\t\t\t\t\thouseNumber:this.form.houseNumber,\r\n\t\t\t\t\t\t\t\t\t\tlongitude:this.form.log,\r\n\t\t\t\t\t\t\t\t\t\tlatitude:this.form.lat,\r\n\t\t\t\t\t\t\t\t\t\tdistrictSite:this.form.village,\r\n\t\t\t\t\t\t\t\t\t\tdistrictDetail:this.form.address,\r\n\t\t\t\t\t\t\t\t\t\tprovinceId:this.form.provinceId,\r\n\t\t\t\t\t\t\t\t\t\tcityId:this.form.cityId,\r\n\t\t\t\t\t\t\t\t\t\tdistrictId:this.form.istrictId,\r\n\t\t\t\t\t\t\t\t\t\tconsumerUname:this.form.name,\r\n\t\t\t\t\t\t\t\t\t\ttelephone:this.form.number,\r\n\t\t\t\t\t\t\t\t\t\tdeviceNum:this.collectorid\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\t\tif(res){//安装成功\r\n\t\t\t\t\t\t\t\t\t\t\tthis.$http.post('/weiXin/api/v1/deviceManager/networkingTest',{deviceNums:[this.form.id],deviceType:this.$route.query.type},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json; charset=UTF-8'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},true)//联网测试\r\n\t\t\t\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(res){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '联网测试';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage:'替换成功，联网测试已下发'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},300)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '联网测试';\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonLoading = false;\r\n\t\t\t\t\t\t\t\t\t\t\tinstance.confirmButtonText = '联网测试';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t \t\r\n\t\t\t\t\t\t\t\t} else if(action === 'cancel'){\t\t\t\t\t//仅替换\r\n\t\t\t\t\t\t\t\t\t\tthis.$http.post('/weiXin/api/v1/deviceMend/replaceDevice',{//设备替换\r\n\t\t\t\t\t\t\t\t\t\tdeviceNumber:this.form.id,\r\n\t\t\t\t\t\t\t\t\t\thouseNumber:this.form.houseNumber,\r\n\t\t\t\t\t\t\t\t\t\tlongitude:this.form.log,\r\n\t\t\t\t\t\t\t\t\t\tlatitude:this.form.lat,\r\n\t\t\t\t\t\t\t\t\t\tdistrictSite:this.form.village,\r\n\t\t\t\t\t\t\t\t\t\tdistrictDetail:this.form.address,\r\n\t\t\t\t\t\t\t\t\t\tprovinceId:this.form.provinceId,\r\n\t\t\t\t\t\t\t\t\t\tcityId:this.form.cityId,\r\n\t\t\t\t\t\t\t\t\t\tdistrictId:this.form.istrictId,\r\n\t\t\t\t\t\t\t\t\t\tconsumerUname:this.form.name,\r\n\t\t\t\t\t\t\t\t\t\ttelephone:this.form.number,\r\n\t\t\t\t\t\t\t\t\t\tdeviceNum:this.collectorid\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.then(res=>{\r\n\t\t\t\t\t\t\t\t\t\tif(res){\r\n\t\t\t\t\t\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype:\"success\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage:'替换成功'\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.catch(err=>{\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}else{\t\t\t\t//点击其他区域关闭 action=close\r\n\t\t\t\t\t\t\t\t\tdone()\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).then((res) => {\r\n\t\t\t\t\t\t\tthis.$router.push('/textonline')\r\n\t\t\t\t\t\t}).catch((action) => {\r\n\t\t\t\t\t\t});\t\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('error submit!!');\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n      }\r\n\t},\r\n  created(){\r\n\t\tthis.getmaparea()\r\n\t},\r\n  mounted(){\r\n\t\tif(this.$route.query.collectorId !==null){\r\n\t\t\t\t this.collectorid = this.$route.query.collectorId\r\n\t\t\t\t this.showdata()\r\n\t\t\t }\r\n\t}\r\n}\r\n</script>\r\n<style  lang=\"less\">\r\n#replace{\r\n\t\r\n\t.textform{\r\n\tpadding: 0 20px 0 20px;\r\n\t}\r\n\t.part{\r\n\tmargin-top: 20px;\r\n\t}\r\n\t.location span{\r\n\t\tmargin-bottom: 20px;\r\n    background-color: #fff;\r\n    background-image: none;\r\n    border-radius: 4px;\r\n    border: 1px solid #dcdfe6;\r\n    -webkit-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n    color: #606266;\r\n    display: inline-block;\r\n    font-size: inherit;\r\n    height: 40px;\r\n    line-height: 40px;\r\n    outline: none;\r\n    padding: 0 15px;\r\n    width: 100%;\r\n\t}\r\n\t.location i{\r\n\r\n\t\tfont-size: 20px;\r\n\t}\r\n\t.selectVillage{\r\n\t\twidth: 100%\r\n\t}\r\n\t.seletArea{\r\n\t\t-webkit-appearance: none;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tbackground-image: none;\r\n\t\t\tborder-radius: 4px;\r\n\t\t\tborder: 1px solid #dcdfe6;\r\n\t\t\t-webkit-box-sizing: border-box;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tcolor: #606266;\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tfont-size: inherit;\r\n\t\t\theight: 40px;\r\n\t\t\tline-height: 40px;\r\n\t\t\toutline: 0;\r\n\t\t\tpadding: 0 15px;\r\n\t\t\t-webkit-transition: border-color .2s cubic-bezier(.645,.045,.355,1);\r\n\t\t\ttransition: border-color .2s cubic-bezier(.645,.045,.355,1);\r\n\t\t\twidth: 100%;\r\n\t}\r\n\t.showMore{\r\n\t\tmargin-top: -15px;\r\n\t}\r\n\t.collectorMore{\r\n\t\ttransition: transform 0.3s ease-out;\r\n\t\ttransform-origin:0 0;\r\n\t\ttransform: rotateX(-90deg) \r\n\t}\r\n\t.ishow{\r\n\t\ttransform: rotateX(0deg);\r\n\t}\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/list/replace/replace.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"replace\"}},[_c('el-form',{ref:\"form\",staticClass:\"textform\",attrs:{\"model\":_vm.form,\"label-width\":\"95px\",\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"新设备编号\",\"prop\":\"id\"}},[_c('el-input',{model:{value:(_vm.form.id),callback:function ($$v) {_vm.$set(_vm.form, \"id\", $$v)},expression:\"form.id\"}}),_vm._v(\" \"),_c('QR')],1),_vm._v(\" \"),_c('el-form-item',{staticClass:\"location\",attrs:{\"label\":\"详细地址\",\"prop\":\"address\"}},[_c('el-input',{attrs:{\"placeholder\":\"街道/单元\"},model:{value:(_vm.form.address),callback:function ($$v) {_vm.$set(_vm.form, \"address\", $$v)},expression:\"form.address\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"具体位置\",\"prop\":\"houseNumber\"}},[_c('el-input',{attrs:{\"placeholder\":\"例：一单元天台\"},model:{value:(_vm.form.houseNumber),callback:function ($$v) {_vm.$set(_vm.form, \"houseNumber\", $$v)},expression:\"form.houseNumber\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"安装地区\"}},[_c('span',{staticClass:\"seletArea\",attrs:{\"prop\":\"area\"},on:{\"click\":function($event){$event.stopPropagation();_vm.slctAddress($event)}}},[_vm._v(_vm._s(_vm.area))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"所属小区\",\"prop\":\"village\"}},[_c('el-select',{ref:\"select\",staticClass:\"selectVillage\",attrs:{\"filterable\":\"\",\"remote\":\"\",\"allow-create\":\"\",\"clearable\":\"\",\"placeholder\":\"XX小区\"},nativeOn:{\"touchstart\":function($event){_vm.getfocus()}},model:{value:(_vm.form.village),callback:function ($$v) {_vm.$set(_vm.form, \"village\", $$v)},expression:\"form.village\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}))],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.onSubmit('form')}}},[_vm._v(\"替换\")])],1),_vm._v(\" \"),_c('el-button',{staticClass:\"showMore\",attrs:{\"type\":\"text\"},on:{\"click\":_vm.showMore}},[_vm._v(\"更多信息\"),_c('i',{staticClass:\"el-icon-arrow-right\"})]),_vm._v(\" \"),_c('div',{ref:\"collectorMore\",staticClass:\"collectorMore\"},[_c('el-form-item',{attrs:{\"label\":\"用户姓名\",\"p\":\"\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"联系电话\"}},[_c('el-input',{model:{value:(_vm.form.number),callback:function ($$v) {_vm.$set(_vm.form, \"number\", $$v)},expression:\"form.number\"}})],1)],1)],1),_vm._v(\" \"),_c('selectAddress',{ref:\"slcAdress\",attrs:{\"areaID\":{pId:_vm.form.provinceId,cId:_vm.form.cityId,iId:_vm.form.istrictId,}},on:{\"reshowarea\":_vm.reshowarea,\"areaConfirm\":_vm.areaConfirm}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-61804473\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.3.0@vue-loader/lib/selector.js?type=template&index=0!./src/components/list/replace/replace.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.0@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-61804473\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=styles&index=0!./replace.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=script&index=0!./replace.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-61804473\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.3.0@vue-loader/lib/selector?type=template&index=0!./replace.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/list/replace/replace.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}