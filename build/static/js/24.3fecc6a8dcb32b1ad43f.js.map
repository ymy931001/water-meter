{"version":3,"sources":["webpack:///src/components/equipErr/equipErr.vue","webpack:///./src/components/equipErr/equipErr.vue?8e3c","webpack:///./src/components/equipErr/equipErr.vue"],"names":["equipErr","value","BScroll","refresh","default","_this","this","type","then","res","deviceNumber","alarmTime","exception","list","_this2","_ref","date","val","multipleSelection","selected","_this3","$https","spread","a","b","c","errWrapper","_this4","equipErr_equipErr","render","_vm","_h","$createElement","_c","_self","attrs","id","staticClass","directives","name","rawName","expression","staticStyle","color","on","click","confirm","_v","ref","width","size","border","stripe","header-row-class-name","row-class-name","data","tableData","selection-change","handleSelectionChange","fixed","filters","filter-method","filterType","prop","label","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"sJAwDeA,0DAMf,+EACA,iBACA,SACA,YACA,6FAQAC,gCAIAC,MAUAC,iEARAC,qCAGA,qEASA,IAAAC,EAAAC,wFAEAC,UACA,WACA,cACA,mBAEA,oCACA,GAAAC,KAAA,SAAAC,8BAEA,+GAGA,cACAC,yBACAC,sBAGAC,uCAGAC,2BAIA,IAAAC,EAAAR,sDAEA,sBACA,OAFAE,KAAA,SAAAO,GAIA,IAAAd,EAAAc,EAAAd,6GAGAe,cAEAf,mBAEA,oCACA,GAAAO,KAAA,SAAAC,eAEAA,kIAKA,yBAMA,kBAEA,2BAGA,gBAEA,2FAcAQ,kEAGAC,mCACAC,oDAIA,IAAAC,EAAAd,gBACA,yEACA,KAAAE,KAAAF,KAAAe,OAAAC,OAAA,SAAAC,EAAAC,EAAAC,WAEA,gEAIAC,oCAGA,IAAAC,EAAArB,4EACA,KAAAE,KAAAF,KAAAe,OAAAC,OAAA,SAAAC,EAAAC,EAAAC,WAEA,gEAIAC,gBC3LeE,GADEC,OAFjB,WAA0B,IAAAC,EAAAxB,KAAayB,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,OAAOC,GAAA,cAAiBH,EAAA,OAAYI,YAAA,UAAoBJ,EAAA,UAAAA,EAAA,aAA+BK,aAAaC,KAAA,OAAAC,QAAA,SAAAvC,MAAA6B,EAAA,QAAAW,WAAA,YAAsEC,aAAeC,MAAA,WAAkBR,OAAQ5B,KAAA,QAAcqC,IAAKC,MAAAf,EAAAgB,WAAqBhB,EAAAiB,GAAA,cAAAjB,EAAAiB,GAAA,KAAAd,EAAA,OAA6Ce,IAAA,aAAAX,YAAA,WAAsCJ,EAAA,YAAiBK,aAAaC,KAAA,UAAAC,QAAA,YAAAvC,MAAA6B,EAAA,KAAAW,WAAA,SAAsEJ,YAAA,eAAAK,aAA0CO,MAAA,QAAed,OAAQe,KAAA,OAAAC,OAAA,GAAAC,OAAA,GAAAC,wBAAA,YAAAC,iBAAA,aAAAC,KAAAzB,EAAA0B,WAA6HZ,IAAKa,mBAAA3B,EAAA4B,yBAA8CzB,EAAA,mBAAwBE,OAAO5B,KAAA,YAAAoD,MAAA,OAAAV,MAAA,QAAgDnB,EAAAiB,GAAA,KAAAd,EAAA,mBAAoCE,OAAOyB,QAAA9B,EAAA8B,QAAAC,gBAAA/B,EAAAgC,WAAAC,KAAA,OAAAC,MAAA,OAAAf,MAAA,QAAgGnB,EAAAiB,GAAA,KAAAd,EAAA,mBAAoCE,OAAO4B,KAAA,OAAAC,MAAA,OAAAf,MAAA,QAA2CnB,EAAAiB,GAAA,KAAAd,EAAA,mBAAoCE,OAAO4B,KAAA,YAAAC,MAAA,UAAmClC,EAAAiB,GAAA,KAAAd,EAAA,mBAAoCE,OAAO4B,KAAA,YAAAC,MAAA,WAAmC,YAExsCC,oBCCjB,IAaAC,EAbyBC,EAAQ,OAajCC,CACEpE,EACA4B,GATF,EATA,SAAAyC,GACEF,EAAQ,SAYV,KAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/24.3fecc6a8dcb32b1ad43f.js","sourcesContent":["<template>\n  <div id=\"equipErr\">\n    <div class=\"block\" >\n        <header>\n            <!-- <el-button type=\"text\">批量处理</el-button> -->\n            <el-button style=\"color:#67c23a\" type=\"text\" @click=\"confirm\" v-show=\"conFirm\">维修确认</el-button>\n        </header>\n        <div class=\"cloWra\" ref=\"errWrapper\">\n            <el-table\n                class=\"searchResult\"\n                size=\"mini\"\n                border\n                stripe\n                v-loading=\"load\"\n                @selection-change=\"handleSelectionChange\"\n                header-row-class-name=\"equipHead\"\n                row-class-name=\"equipTabel\"\n                :data=\"tableData\"\n                style=\"width: 100%\">\n                <el-table-column\n                type=\"selection\"\n                fixed=\"left\"\n                width=\"45\">\n                </el-table-column>\n                <el-table-column \n                    :filters=\"filters\"\n                    :filter-method=\"filterType\"\n                    prop=\"type\"\n                    label=\"设备类型\"\n                    width=\"85\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"date\"\n                    label=\"设备编号\"\n                    width=\"95\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"alarmTime\"\n                    label=\"报警时间\">\n                </el-table-column>\n                <el-table-column\n                    prop=\"exception\"\n                    label=\"异常原因\"\n                    >\n                </el-table-column>\n                \n            </el-table>\n        </div>\n    </div>\n                \n      \n  </div>\n</template>\n\n<script>\n\nexport default {\n  components:{},\n  props:{},\n  data(){\n    return {\n    conFirm:false,\n    filters:[{text: '水表', value: '水表'},{text: '无线单表', value: '无线单表'},{text: '采集器', value: '采集器'}],\n    selected:'',\n    load:false,\n    errScroll:null,\n    tableData: []\n    }\n  },\n  watch:{},\n  computed:{},\n  methods:{\n        filterType(value,row,column){\n            return row.type === value;\n        },\n        initScroll(Obj,SCobj){\n            if( !Obj ){\n                var BScroll\n                import('better-scroll').then(res=>{\n                    BScroll = res.default\n                    Obj = new BScroll(SCobj,{\n                    eventPassthrough:\"horizontal\",\n                    })\n                    Obj.on('scroll',(pos)=>{\n                    })\n                })\n            }else{\n                Obj.refresh() \n            }\n        },\n        searchdata(type){\n            \n            return this.$http.get('/weiXin/api/v1/deviceMend/getDeviceExceptions',{\n                deviceTypes:type,\n                pageNum: 1,\n                pageSize: 30,\n                searchType:1\n            },{\n                'Content-Type': 'application/json; charset=UTF-8'\n            },true)\n            .then(res=>{\n                if(res&&res.data.data.length>0){\n                    let list = res.data.data.map(val=>{\n                        return {\n                            type:(val.deviceType==2&&'采集器')||(val.deviceType==3&&'水表')||(val.deviceType==1&&'无线单表'),\n                            date:val.deviceNumber,\n                            alarmTime:val.alarmTime,\n                            exception:val.exception\n\n                        }\n                    })\n                    this.tableData=[...list]\n\n                }\n            })\n        },\n        confirm() {\n            this.$prompt('请输入维修信息', '设备维修', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            // inputErrorMessage: '邮箱格式不正确'\n        }).then(({ value }) => {\n            this.$http.post('/weiXin/api/v1/deviceMend/mendDevice',{\n                deviceNumbers:this.selected.map(val=>{\n                    return val.date\n                }),\n                remark:value\n            },{\n                'Content-Type': 'application/json; charset=UTF-8'\n            },true)\n            .then(res=>{\n                console.log(res)\n                if(res.data.code==0){\n                    this.selected.forEach((VAL,IND)=>[\n                        this.tableData.forEach((val,ind)=>{\n                            if(val.date==VAL.date){\n                                this.tableData.splice(ind,1)\n                            }\n                        })\n                    ])\n                    \n                    this.$message({\n                    type: 'success',\n                    message: '维修成功'\n                    });\n                }else{\n                    this.$message({\n                    type: 'error',\n                    message: '维修失败'\n                    });\n                }\n                \n            })\n            \n        }).catch(() => {\n            // this.$message({\n            // type: 'info',\n            // message: '取消输入'\n            // });       \n        });\n      },\n      handleSelectionChange(val) {\n        \n        this.multipleSelection = val;\n        this.conFirm=this.multipleSelection.length>0?true:false;\n        this.selected=this.multipleSelection\n \n        console.log(this.selected)\n      },\n  },\n  created(){},\n  mounted(){\n      this.load=true \n      this.$https.all([this.searchdata(1),this.searchdata(2),this.searchdata(3)])\n        .then(this.$https.spread((a,b,c)=>{\n           this.load=false\n        }))\n        this.$nextTick(()=>{\n            this.initScroll(this.errScroll,this.$refs.errWrapper);\n\n        });\n  },\n  activated(){\n      this.$https.all([this.searchdata(1),this.searchdata(2),this.searchdata(3)])\n        .then(this.$https.spread((a,b,c)=>{\n           this.load=false\n        }))\n        this.$nextTick(()=>{\n            this.initScroll(this.errScroll,this.$refs.errWrapper);\n\n        });\n  }\n}\n</script>\n<style lang=\"less\">\n\t#equipErr{\n        background: #fff;\n\t\t.el-date-editor{\n\t\t\tmargin-top: 20px;\n\t\t\twidth: 320px;\n\t\t}\n\t\t.block{\n            header{\n                padding: 0 20px 0 20px;\n                display: flex;\n                justify-content: flex-end;\n            }\n\t\t\t.idSearch{\n\t\t\t\twidth: 320px;\n\t\t\t\tmargin-top: 20px;\n\t\t\t}\n\t\t\t.searchConfirm{\n\t\t\t\twidth: 320px;\n\t\t\t\tmargin-top: 20px;\n\t\t\t}\n\t\t\t\n            .cloWra{\n                height: 67vh;\n                overflow: hidden;\n                .searchResult{\n                    margin:0 0px 50px 0px;\n                    min-height:calc(100% + 1px)\n                }\n\t    \t}   \n\t\t}\n\t}\n\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/equipErr/equipErr.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"equipErr\"}},[_c('div',{staticClass:\"block\"},[_c('header',[_c('el-button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.conFirm),expression:\"conFirm\"}],staticStyle:{\"color\":\"#67c23a\"},attrs:{\"type\":\"text\"},on:{\"click\":_vm.confirm}},[_vm._v(\"维修确认\")])],1),_vm._v(\" \"),_c('div',{ref:\"errWrapper\",staticClass:\"cloWra\"},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.load),expression:\"load\"}],staticClass:\"searchResult\",staticStyle:{\"width\":\"100%\"},attrs:{\"size\":\"mini\",\"border\":\"\",\"stripe\":\"\",\"header-row-class-name\":\"equipHead\",\"row-class-name\":\"equipTabel\",\"data\":_vm.tableData},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"fixed\":\"left\",\"width\":\"45\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"filters\":_vm.filters,\"filter-method\":_vm.filterType,\"prop\":\"type\",\"label\":\"设备类型\",\"width\":\"85\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"date\",\"label\":\"设备编号\",\"width\":\"95\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"alarmTime\",\"label\":\"报警时间\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"exception\",\"label\":\"异常原因\"}})],1)],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6656edab\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/equipErr/equipErr.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6656edab\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./equipErr.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./equipErr.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6656edab\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./equipErr.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/equipErr/equipErr.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}