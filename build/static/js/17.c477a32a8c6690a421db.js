webpackJsonp([17],{HgVP:function(e,t){},m1cA:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Gu7T"),s=i.n(n),a=i("//Fk"),r=i.n(a),o=i("GQaK"),l={components:{},props:{},data:function(){return{tableData:[],timechoice:"",recordWrapper:null,pageNum:1,isDown:!1,isUp:!1,isEnd:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]}}},watch:{},computed:{refreshTxt:function(){return this.isEnd?"--无更多数据--":"--上拉加载更多--"}},methods:{searchHistory:function(){this.getRecord()},getRecord:function(){var e=this;return new r.a(function(t){e.$http.get("/weiXin/api/v1/historyReading/getHistoryOnline",{deviceNum:e.$route.query.deviceId,startTime:e.timechoice?e.timechoice[0]:null,endTime:e.timechoice?e.timechoice[1]:null,pageNum:e.pageNum,pageSize:15}).then(function(e){e&&t(e.data.data)})})},getListDataFromNet:function(e,t){var i=this;setTimeout(function(){i.getRecord(e).then(function(e){t(e)})},1e3)},initScroll:function(e,t){var i=this;e?e.refresh():((e=new o.default(t,{eventPassthrough:"horizontal",pullUpLoad:{threshold:-50},pullDownRefresh:{threshold:55,txt:"刷新"}})).on("scroll",function(e){i.isDown?i.isDown?i.$refs.freshing.style.transform="translate(0,20px)":i.isUp:(e.y>20?i.$refs.isDown.style.visibility="visible":i.$refs.isDown.style.visibility="hidden",i.$refs.isDown.style.transform="translate(0,"+(e.y-40)+"px)")}),e.on("pullingUp",function(){i.isUp=!0,i.pageNum++,i.getListDataFromNet(i.pageNum,function(t){var n;0==t.length&&(i.isEnd=!0),(n=i.tableData).push.apply(n,s()(t)),i.isUp=!1,e.refresh(),e.finishPullUp()})}),e.on("pullingDown",function(){i.isDown=!0,i.pageNum=1,i.getListDataFromNet(i.pageNum,function(t){var n;i.tableData=[],(n=i.tableData).push.apply(n,s()(t)),i.isDown=!1,e.refresh(),e.finishPullDown(),t.length})}))}},created:function(){},mounted:function(){var e=this;this.getRecord().then(function(t){e.tableData=t,e.initScroll(e.recordWrapper,e.$refs.recordScroll)})}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"offlineRecord"},[i("p",{staticStyle:{"font-size":"17px","line-height":"30px"}},[e._v("设备ID:"+e._s(e.$route.query.deviceId)+" ")]),e._v(" "),i("el-row",{staticClass:"selectTime",attrs:{type:"flex"}},[i("el-col",{attrs:{span:20}},[i("el-date-picker",{ref:"select",attrs:{editable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","popper-class":"timeSelect2",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","picker-options":e.pickerOptions},model:{value:e.timechoice,callback:function(t){e.timechoice=t},expression:"timechoice"}})],1),e._v(" "),i("el-col",{attrs:{span:4}},[i("el-button",{staticClass:"search",on:{click:e.searchHistory}},[e._v("查询")])],1)],1),e._v(" "),i("div",{staticClass:"block"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDown,expression:"!isDown"}],ref:"isDown",staticClass:"isDown"},[e._v("刷新数据")]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isDown,expression:"isDown"}],ref:"freshing"},[i("i",{staticClass:"el-icon-loading"}),e._v("刷新中")]),e._v(" "),i("div",{ref:"recordScroll",staticClass:"Wrapper"},[i("div",[i("el-table",{staticClass:"searchResult",attrs:{size:"mini",border:"",data:e.tableData}},[i("el-table-column",{attrs:{fixed:"",prop:"date",label:"读数时间"}}),e._v(" "),i("el-table-column",{attrs:{label:"状态",prop:"reading"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("span",{style:{color:1==n.onlineOffline?"green":"#f56c6c"}},[e._v("\n                            "+e._s(1==n.onlineOffline?"上线":"下线")+"\n\n                            ")])]}}])})],1),e._v(" "),e.isUp?i("div",{ref:"download"},[i("i",{staticClass:"el-icon-loading"}),e._v("加载中")]):i("div",{ref:"isUp"},[e._v(e._s(e.refreshTxt))])],1)])])],1)},staticRenderFns:[]};var u=i("VU/8")(l,c,!1,function(e){i("HgVP")},null,null);t.default=u.exports}});
//# sourceMappingURL=17.c477a32a8c6690a421db.js.map